@model IEnumerable<Inuplan.Common.DTOs.ImageDTO>

@{
    ViewBag.Title = "UserImages";
    bool CanEdit = ViewBag.CanEdit;
    var fullname = new Func<int, string>(id =>
    {
        var entity = Model.SingleOrDefault(e => e.ImageID == id);
        return string.Format("{0}.{1}", entity.Filename, entity.Extension);
    });
}

<div class="container">
    <div class="row"><div class="col-md-12"><p></p></div></div>
    <div class="row">
        <div class="col-md-12">
            <div class="jumbotron">
                <h1>@ViewBag.Username's images</h1>
            </div>
        </div>
    </div>
    
    <div class="row">
        <div class="col-lg-12">
            @for (int i = 0; i < Model.Count(); i++)
            {
                var item = Model.ElementAt(i);
                var isRow = (i+1 % 7) == 0;

                if(isRow)
                {
                    @Html.Raw("<div class=\"row\"");
                }

                <div class="col-md-2">
                    <a href="@item.PathOriginalUrl">
                        <img src="@item.PathThumbnailUrl" alt="@item.Filename" id="@item.ImageID" />
                    </a>

                    @if (CanEdit)
                    {
                        var filename = fullname(item.ImageID);
                        <p class="text-center">
                            <input type="checkbox" form="form-delete" name="images" class="checkbox" value="@filename" />
                        </p>
                    }
                </div>

                if (isRow)
                {
                    @Html.Raw("</div>");
                }
            }
        </div>
    </div>
    
    @if (CanEdit)
    {
        <div class="row">
            <div class="col-md-4 col-md-offset-4">
                <form class="form-inline"
                      id="form-upload"
                      action="@Url.Action("Upload")"
                      method="post"
                      enctype="multipart/form-data">
                    <input type="file" class="form-control" id="files" name="files" multiple />
                    <input type="submit" class="btn btn-primary" id="upload" value="Upload" />
                </form>
            </div>
            <div class="col-md-2">
                <form class="form-inline"
                      id="form-delete"
                      action="@Url.Action("Delete")"
                      method="delete">
                    <input type="submit" class="btn btn-danger" id="delete" value="Delete Selected Images" />
                </form>
            </div>
        </div>
    }
</div>