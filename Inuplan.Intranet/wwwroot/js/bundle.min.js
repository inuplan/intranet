"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}function union(e,t,r){for(var o=e.concat(t),n=0;n<o.length;n++)for(var a=n+1;a<o.length;a++)r(o[n],o[a])&&(o.splice(a,1),a--);return o}function setCurrentUserId(e){return{type:SET_CURRENT_USER_ID,id:e}}function addUser(e){return{type:ADD_USER,user:e}}function recievedUsers(e){return{type:RECIEVED_USERS,users:e}}function fetchCurrentUser(e){return function(t){var r=getUrl(e),o=responseHandler.bind(this,t);return fetch(r,options).then(o).then(function(e){t(setCurrentUserId(e.ID)),t(addUser(e))},onReject)}}function fetchUsers(){return function(e){var t=responseHandler.bind(this,e);return fetch(globals.urls.users,options).then(t).then(function(t){var r=function(e){return e.ID},o=function(e){return e},n=objMap(t,r,o);e(recievedUsers(n))},onReject)}}function setLatest(e){return{type:SET_LATEST,latest:e}}function setSKip(e){return{type:SET_SKIP_WHATS_NEW,skip:e}}function setTake(e){return{type:SET_TAKE_WHATS_NEW,take:e}}function setPage(e){return{type:SET_PAGE_WHATS_NEW,page:e}}function setTotalPages(e){return{type:SET_TOTAL_PAGES_WHATS_NEW,totalPages:e}}function fetchLatestNews(e,t){return function(r){var o=globals.urls.whatsnew+"?skip="+e+"&take="+t,n=responseHandler.bind(this,r);return fetch(o,options).then(n).then(function(o){var n=o.CurrentItems;n.forEach(function(e){var t=e.Item.Author;t&&r(addUser(t))}),r(setSKip(e)),r(setTake(t)),r(setPage(o.CurrentPage)),r(setTotalPages(o.TotalPages));var a=n.map(normalizeLatest);r(setLatest(a))},onReject)}}function setCurrentPage(e){return{type:SET_CURRENT_PAGE,page:e}}function setTotalPages$2(e){return{type:SET_TOTAL_PAGES,totalPages:e}}function receivedComments(e){return{type:RECIEVED_COMMENTS,comments:e}}function setFocusedComment(e){return{type:SET_FOCUSED_COMMENT,id:e}}function fetchComments(e,t,r){return function(o){var n=responseHandler.bind(this,o);return fetch(e,options).then(n).then(function(e){var n=e.CurrentItems;o(setSkipComments(t)),o(setTakeComments(r)),o(setCurrentPage(e.CurrentPage)),o(setTotalPages$2(e.TotalPages));var a=n.map(normalizeComment);o(receivedComments(a))},onReject)}}function setImagesOwner(e){return{type:SET_IMAGES_OWNER,id:e}}function recievedUserImages(e){return{type:RECIEVED_USER_IMAGES,images:e}}function addImage(e){return{type:ADD_IMAGE,key:e.ImageID,val:e}}function removeImage(e){return{type:REMOVE_IMAGE,key:e}}function addSelectedImageId(e){return{type:ADD_SELECTED_IMAGE_ID,id:e}}function removeSelectedImageId(e){return{type:REMOVE_SELECTED_IMAGE_ID,id:e}}function clearSelectedImageIds(){return{type:CLEAR_SELECTED_IMAGE_IDS}}function deleteImage(e,t){return function(r){var o=globals.urls.images+"?username="+t+"&id="+e,n=Object.assign({},options,{method:"DELETE"}),a=responseHandler.bind(this,r);return fetch(o,n).then(a).then(function(){return r(removeImage(e))},onReject)}}function uploadImage(e,t,r,o){return function(n){var a=globals.urls.images+"?username="+e,s=Object.assign({},options,{method:"POST",body:t}),c=responseHandler.bind(this,n);return fetch(a,s).then(c).then(r,o)}}function fetchUserImages(e){return function(t,r){var o=globals.urls.images+"?username="+e,n=responseHandler.bind(this,t),a=function(e){var r=e.map(normalizeImage).reverse(),o=objMap(r,function(e){return e.ImageID},function(e){return e});t(recievedUserImages(o))};return fetch(o,options).then(n).then(a,onReject)}}function deleteImages(e,t){return void 0===t&&(t=[]),function(r){var o=t.join(),n=globals.urls.images+"?username="+e+"&ids="+o,a=Object.assign({},options,{method:"DELETE"}),s=responseHandler.bind(this,r);return fetch(n,a).then(s).then(function(){return r(clearSelectedImageIds())},onReject).then(function(){return r(fetchUserImages(e))})}}function setImageOwner(e){return function(t,r){var o=function(){return underscore.find(r().usersInfo.users,function(t){return t.Username==e})},n=o();if(n){var a=n.ID;return t(setImagesOwner(a)),Promise.resolve()}var s=globals.urls.users+"?username="+e,c=responseHandler.bind(this,t);return fetch(s,options).then(c).then(function(e){return t(addUser(e))},onReject).then(function(){n=o(),t(setImagesOwner(n.ID))})}}function fetchSingleImage(e){return function(t,r){var o=globals.urls.images+"/getbyid?id="+e,n=responseHandler.bind(this,t);return fetch(o,options).then(n).then(function(e){if(e){var r=normalizeImage(e);t(addImage(r))}})}}function setUsedSpacekB(e){return{type:SET_USED_SPACE_KB,usedSpace:e}}function setTotalSpacekB(e){return{type:SET_TOTAL_SPACE_KB,totalSpace:e}}var React=_interopDefault(require("react")),ReactDOM=_interopDefault(require("react-dom")),reactRouter=require("react-router"),reactBootstrap=require("react-bootstrap"),reactRedux=require("react-redux"),underscore=require("underscore"),fetch=_interopDefault(require("isomorphic-fetch")),marked=_interopDefault(require("marked")),removeMd=_interopDefault(require("remove-markdown")),redux=require("redux"),thunk=_interopDefault(require("redux-thunk")),NavLink=function(e){function t(t,r){e.call(this,t)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(){var e=this.context.router.isActive(this.props.to,!0),t=e?"active":"";return React.createElement("li",{className:t},React.createElement(reactRouter.Link,{to:this.props.to},this.props.children))},t}(React.Component);NavLink.contextTypes={router:React.PropTypes.object};var IndexNavLink=function(e){function t(t,r){e.call(this,t)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(){var e=this.context.router.isActive(this.props.to,!0),t=e?"active":"";return React.createElement("li",{className:t},React.createElement(reactRouter.IndexLink,{to:this.props.to},this.props.children))},t}(React.Component);IndexNavLink.contextTypes={router:React.PropTypes.object};var Error=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(){var e=this.props,t=e.clearError,r=e.title,o=e.message;return React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lgOffset:2,lg:8},React.createElement(reactBootstrap.Alert,{bsStyle:"danger",onDismiss:t},React.createElement("strong",null,r),React.createElement("p",null,o))))},t}(React.Component),SET_SELECTED_IMG="SET_SELECTED_IMG",ADD_IMAGE="ADD_IMAGE",REMOVE_IMAGE="REMOVE_IMAGE",SET_IMAGES_OWNER="SET_IMAGES_OWNER",RECIEVED_USER_IMAGES="RECIEVED_USER_IMAGES",ADD_SELECTED_IMAGE_ID="ADD_SELECTED_IMAGE_ID",REMOVE_SELECTED_IMAGE_ID="REMOVE_SELECTED_IMAGE_ID",CLEAR_SELECTED_IMAGE_IDS="CLEAR_SELECTED_IMAGE_IDS",INCR_IMG_COMMENT_COUNT="INCR_IMG_COMMENT_COUNT",DECR_IMG_COMMENT_COUNT="DECR_IMG_COMMENT_COUNT",SET_CURRENT_USER_ID="SET_CURRENT_USER_ID",ADD_USER="ADD_USER",RECIEVED_USERS="RECIEVED_USERS",ADD_COMMENT="ADD_COMMENT",RECIEVED_COMMENTS="RECIEVED_COMMENTS",SET_CURRENT_PAGE="SET_CURRENT_PAGE",SET_TOTAL_PAGES="SET_TOTAL_PAGES",SET_SKIP_COMMENTS="SET_SKIP_COMMENTS",SET_TAKE_COMMENTS="SET_TAKE_COMMENTS",SET_FOCUSED_COMMENT="SET_FOCUSED_COMMENT",SET_LATEST="SET_LATEST",SET_SKIP_WHATS_NEW="SET_SKIP_WHATS_NEW",SET_TAKE_WHATS_NEW="SET_TAKE_WHATS_NEW",SET_PAGE_WHATS_NEW="SET_PAGE_WHATS_NEW",SET_TOTAL_PAGES_WHATS_NEW="SET_TOTAL_PAGES_WHATS_NEW",SET_ERROR_TITLE="SET_ERROR_TITLE",SET_ERROR_MESSAGE="SET_ERROR_MESSAGE",SET_HAS_ERROR="SET_HAS_ERROR",CLEAR_ERROR_TITLE="CLEAR_ERROR_TITLE",CLEAR_ERROR_MESSAGE="CLEAR_ERROR_MESSAGE",SET_THREAD_TITLES="SET_THREAD_TITLES",SET_TOTAL_PAGES_THREADS="SET_TOTAL_PAGES_THREADS",SET_PAGE_THREADS="SET_PAGE_THREADS",SET_SKIP_THREADS="SET_SKIP_THREAD",SET_TAKE_THREADS="SET_TAKE_THREADS",SET_SELECTEDTHREAD_ID="SET_SELECTEDTHREAD_ID",SET_POST_CONTENT="SET_POST_CONTENT",ADD_THREAD_TITLE="ADD_THREAD_TITLE",UPDATE_THREAD_TITLE="UPDATE_THREAD_TITLE",SET_USED_SPACE_KB="SET_USED_SPACE_KB",SET_TOTAL_SPACE_KB="SET_TOTAL_SPACE_KB",setErrorTitle=function(e){return{type:SET_ERROR_TITLE,title:e}},clearErrorTitle=function(){return{type:CLEAR_ERROR_TITLE}},setErrorMessage=function(e){return{type:SET_ERROR_MESSAGE,message:e}},clearErrorMessage=function(){return{type:CLEAR_ERROR_MESSAGE}},clearError=function(){return function(e){return e(clearErrorTitle()),e(clearErrorMessage()),e(setHasError(!1)),Promise.resolve()}},setHasError=function(e){return{type:SET_HAS_ERROR,hasError:e}},setError=function(e){return function(t){return t(setHasError(!0)),t(setErrorTitle(e.title)),t(setErrorMessage(e.message)),Promise.resolve()}},HttpError=function(e,t){this.title=e,this.message=t},mapStateToProps=function(e){var t=underscore.values(e.usersInfo.users).filter(function(e){return e.Username.toUpperCase()==globals.currentUsername.toUpperCase()})[0],r=t?t.FirstName:"User";return{hasError:e.statusInfo.hasError,error:e.statusInfo.errorInfo,name:r}},mapDispatchToProps=function(e){return{clearError:function(){return e(clearError())}}},Shell=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.errorView=function(){var e=this.props,t=e.hasError,r=e.clearError,o=e.error,n=o.title,a=o.message;return t?React.createElement(Error,{title:n,message:a,clearError:r}):null},t.prototype.render=function(){var e=this.props,t=e.name,r=globals.urls.employeeHandbook,o=globals.urls.c5Search;return React.createElement(reactBootstrap.Grid,{fluid:!0},React.createElement(reactBootstrap.Navbar,{fixedTop:!0},React.createElement(reactBootstrap.Navbar.Header,null,React.createElement(reactBootstrap.Navbar.Brand,null,React.createElement(reactRouter.Link,{to:"/",className:"navbar-brand"},"Inuplan Intranet")),React.createElement(reactBootstrap.Navbar.Toggle,null)),React.createElement(reactBootstrap.Navbar.Collapse,null,React.createElement(reactBootstrap.Nav,null,React.createElement(IndexNavLink,{to:"/"},"Forside"),React.createElement(NavLink,{to:"/forum"},"Forum"),React.createElement(NavLink,{to:"/users"},"Brugere"),React.createElement(NavLink,{to:"/about"},"Om")),React.createElement(reactBootstrap.Navbar.Text,{pullRight:!0},"Hej, ",t,"!"),React.createElement(reactBootstrap.Nav,{pullRight:!0},React.createElement(reactBootstrap.NavDropdown,{eventKey:5,title:"Links",id:"extern_links"},React.createElement(reactBootstrap.MenuItem,{href:r,eventKey:5.1},"Medarbejder håndbog"),React.createElement(reactBootstrap.MenuItem,{href:o,eventKey:5.2},"C5 Søgning"))))),this.errorView(),this.props.children)},t}(React.Component),Main=reactRedux.connect(mapStateToProps,mapDispatchToProps)(Shell),options={mode:"cors",credentials:"include"},getFullName=function(e,t){return void 0===t&&(t=""),e?e.FirstName+" "+e.LastName:t},normalizeImage=function(e){return{ImageID:e.ImageID,Filename:e.Filename,Extension:e.Extension,OriginalUrl:e.OriginalUrl,PreviewUrl:e.PreviewUrl,ThumbnailUrl:e.ThumbnailUrl,CommentCount:e.CommentCount,Uploaded:new Date(e.Uploaded)}},normalizeComment=function(e){var t=e.Replies?e.Replies:[],r=t.map(normalizeComment),o=e.Deleted?-1:e.Author.ID;return{CommentID:e.ID,AuthorID:o,Deleted:e.Deleted,PostedOn:e.PostedOn,Text:e.Text,Replies:r,Edited:e.Edited}},normalizeLatest=function(e){var t=null,r=-1;if(1==e.Type){var o=e.Item;t={Extension:o.Extension,Filename:o.Filename,ImageID:o.ImageID,OriginalUrl:o.OriginalUrl,PreviewUrl:o.PreviewUrl,ThumbnailUrl:o.ThumbnailUrl,Uploaded:o.Uploaded},r=e.Item.Author.ID}else if(2==e.Type){var n=e.Item;t={ID:n.ID,Text:n.Text,ImageID:n.ImageID,ImageUploadedBy:n.ImageUploadedBy,Filename:n.Filename},r=e.Item.Author.ID}else if(4==e.Type){var a=e.Item;t={ID:a.ThreadID,Title:a.Header.Title,Text:a.Text,Sticky:a.Header.Sticky,CommentCount:a.Header.CommentCount},r=a.Header.Author.ID}return{ID:e.ID,Type:e.Type,Item:t,On:e.On,AuthorID:r}},normalizeThreadTitle=function(e){var t=e.ViewedBy.map(function(e){return e.ID}),r=e.LatestComment?normalizeComment(e.LatestComment):null;return{ID:e.ID,IsPublished:e.IsPublished,Sticky:e.Sticky,CreatedOn:e.CreatedOn,AuthorID:e.Author.ID,Deleted:e.Deleted,IsModified:e.IsModified,Title:e.Title,LastModified:e.LastModified,LatestComment:r,CommentCount:e.CommentCount,ViewedBy:t}},getImageCommentsPageUrl=function(e,t,r){return globals.urls.imagecomments+"?imageId="+e+"&skip="+t+"&take="+r},getImageCommentsDeleteUrl=function(e){return globals.urls.imagecomments+"?commentId="+e},getForumCommentsPageUrl=function(e,t,r){return globals.urls.forumcomments+"?postId="+e+"&skip="+t+"&take="+r},getForumCommentsDeleteUrl=function(e){return globals.urls.forumcomments+"?commentId="+e},formatText=function(e){if(e){var t=marked(e,{sanitize:!0});return{__html:t}}},getWords=function(e,t){if(!e)return"";var r=removeMd(e);return r.split(/\s+/).slice(0,t).join(" ")},timeText=function(e){var t=moment(e).fromNow(),r=moment().diff(e,"hours",!0);if(r>=12.5){var o=moment(e);return"d. "+o.format("D MMM YYYY ")+"kl. "+o.format("H:mm")}return"for "+t},responseHandler=function(e,t){if(t.ok)return t.json();switch(t.status){case 400:e(setError(new HttpError("400 Bad Request","The request was not well-formed")));break;case 404:e(setError(new HttpError("404 Not Found","Could not find resource")));break;case 408:e(setError(new HttpError("408 Request Timeout","The server did not respond in time")));case 500:e(setError(new HttpError("500 Server Error","Something went wrong with the API-server")));break;default:e(setError(new HttpError("Oops","Something went wrong!")))}return Promise.reject()},onReject=function(){},put=function(e,t,r){var o=Object.assign({},e);return o[t]=r,o},objMap=function(e,t,r){var o=e.reduce(function(e,o){var n=t(o),a=r(o);return e[n]=a,e},{});return o},getUrl=function(e){return globals.urls.users+"?username="+e},CommentProfile=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(){return React.createElement(reactBootstrap.Media.Left,{className:"comment-profile"},React.createElement(reactBootstrap.Image,{src:"/images/person_icon.svg",style:{width:"64px",height:"64px"},className:"media-object"}),this.props.children)},t}(React.Component),WhatsNewTooltip=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.tooltipView=function(e){return React.createElement(reactBootstrap.Tooltip,{id:"tooltip"},e)},t.prototype.render=function(){var e=this.props,t=e.tooltip,r=e.children;return React.createElement(reactBootstrap.OverlayTrigger,{placement:"left",overlay:this.tooltipView(t)},r)},t}(React.Component),WhatsNewItemImage=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.when=function(){var e=this.props,t=e.on;return"uploadede "+timeText(t)},t.prototype.overlay=function(){return React.createElement(reactBootstrap.Tooltip,{id:"tooltip_img"},"Bruger billede")},t.prototype.render=function(){var e=this.props,t=e.imageId,r=(e.commentId,e.author),o=e.filename,n=e.extension,a=e.thumbnail,s=r.Username,c=o+"."+n,i=s+"/gallery/image/"+t,l=r.FirstName+" "+r.LastName;return React.createElement(WhatsNewTooltip,{tooltip:"Uploadet billede"},React.createElement(reactBootstrap.Media.ListItem,{className:"whatsnewItem hover-shadow"},React.createElement(CommentProfile,null),React.createElement(reactBootstrap.Media.Body,null,React.createElement("blockquote",null,React.createElement(reactRouter.Link,{to:i},React.createElement(reactBootstrap.Image,{src:a,thumbnail:!0})),React.createElement("footer",null,l," ",this.when(),React.createElement("br",null),React.createElement(reactBootstrap.Glyphicon,{glyph:"picture"})," ",c)))))},t}(React.Component),WhatsNewItemComment=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.createSummary=function(){var e=this.props,t=e.text;return formatText(getWords(t,5)+"...")},t.prototype.fullname=function(){var e=this.props,t=e.author;return t.FirstName+" "+t.LastName},t.prototype.when=function(){var e=this.props,t=e.on;return"sagde "+timeText(t)},t.prototype.render=function(){var e=this.props,t=e.imageId,r=e.uploadedBy,o=e.commentId,n=(e.author,e.filename),a=r.Username,s=this.fullname(),c=this.createSummary(),i=a+"/gallery/image/"+t+"/comment?id="+o;return React.createElement(WhatsNewTooltip,{tooltip:"Kommentar"},React.createElement(reactBootstrap.Media.ListItem,{className:"whatsnewItem hover-shadow"},React.createElement(CommentProfile,null),React.createElement(reactBootstrap.Media.Body,null,React.createElement("blockquote",null,React.createElement(reactRouter.Link,{to:i},React.createElement("em",null,React.createElement("p",{dangerouslySetInnerHTML:c}))),React.createElement("footer",null,s," ",this.when(),React.createElement("br",null),React.createElement(reactBootstrap.Glyphicon,{glyph:"comment"})," ",n)))))},t}(React.Component),WhatsNewForumPost=function(e){function t(t){e.call(this,t),this.showModal=this.showModal.bind(this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.fullname=function(){var e=this.props,t=e.author;return t.FirstName+" "+t.LastName},t.prototype.when=function(){var e=this.props,t=e.on;return"indlæg "+timeText(t)},t.prototype.summary=function(){var e=this.props,t=e.text;return getWords(t,5)},t.prototype.overlay=function(){var e=this.props,t=e.commentCount;return React.createElement(reactBootstrap.Tooltip,{id:"tooltip_post"},"Forum indlæg, antal kommentarer: ",t)},t.prototype.showModal=function(e){e.preventDefault();var t=this.props,r=t.preview,o=t.index;r(o)},t.prototype.render=function(){var e=this.props,t=e.title,r=(e.postId,this.fullname());return React.createElement(WhatsNewTooltip,{tooltip:"Forum indlæg"},React.createElement(reactBootstrap.Media.ListItem,{className:"whatsnewItem hover-shadow"},React.createElement(CommentProfile,null),React.createElement(reactBootstrap.Media.Body,null,React.createElement("blockquote",null,React.createElement("a",{href:"#",onClick:this.showModal},this.summary(),"..."),React.createElement("footer",null,r," ",this.when(),React.createElement("br",null),React.createElement(reactBootstrap.Glyphicon,{glyph:"list-alt"})," ",t)))))},t}(React.Component),WhatsNewList=function(e){function t(t){e.call(this,t),this.previewPostHandle=this.previewPostHandle.bind(this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.previewPostHandle=function(e){var t=this.props,r=t.items,o=t.preview,n=r[e];o(n)},t.prototype.constructItems=function(){var e=this,t=this.props,r=t.items,o=t.getUser,n=(t.preview,function(e){return"whatsnew_"+e});return r.map(function(t,r){var a=n(t.ID),s=o(t.AuthorID);switch(t.Type){case 1:return React.createElement(WhatsNewItemImage,{id:t.ID,on:t.On,imageId:t.Item.ImageID,filename:t.Item.Filename,extension:t.Item.Extension,thumbnail:t.Item.ThumbnailUrl,preview:t.Item.PreviewUrl,author:s,key:a});case 2:return React.createElement(WhatsNewItemComment,{id:t.ID,commentId:t.Item.ID,text:t.Item.Text,uploadedBy:t.Item.ImageUploadedBy,imageId:t.Item.ImageID,on:t.On,author:s,filename:t.Item.Filename,key:a});case 4:return React.createElement(WhatsNewForumPost,{on:t.On,author:s,title:t.Item.Title,text:t.Item.Text,sticky:t.Item.Sticky,postId:t.Item.ID,commentCount:t.Item.CommentCount,preview:e.previewPostHandle,index:r,key:a})}})},t.prototype.render=function(){var e=this.constructItems();return React.createElement(reactBootstrap.Media.List,null,e)},t}(React.Component),ForumForm=function(e){function t(t){e.call(this,t),this.state={Title:"",Text:"",Sticky:!1,IsPublished:!0},this.handleSubmit=this.handleSubmit.bind(this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.componentWillReceiveProps=function(e){var t=e.edit;t&&this.setState({Title:t.Title,Text:t.Text,Sticky:t.Sticky,IsPublished:t.IsPublished})},t.prototype.handleTitleChange=function(e){this.setState({Title:e.target.value})},t.prototype.handleTextChange=function(e){this.setState({Text:e.target.value})},t.prototype.getValidation=function(){var e=this.state.Title.length;return e>0&&e<200?"success":e>=200&&e<=250?"warning":e>250?"error":void 0},t.prototype.transformToDTO=function(e){return{Header:{IsPublished:e.IsPublished,Sticky:e.Sticky,Title:e.Title},Text:e.Text}},t.prototype.handleSubmit=function(e){e.preventDefault();var t=this.props,r=t.close,o=t.onSubmit,n=this.transformToDTO(this.state);o(n),r()},t.prototype.handleSticky=function(){var e=this.state,t=e.Sticky;this.setState({Sticky:!t})},t.prototype.handlePublished=function(){var e=this.state,t=e.IsPublished;this.setState({IsPublished:!t})},t.prototype.closeHandle=function(){var e=this.props,t=e.close;t()},t.prototype.render=function(){var e=this.props,t=e.show,r=e.edit,o=Boolean(!r),n=o?"Skriv nyt indlæg":"Ændre indlæg",a=o?"Skriv indlæg":"Gem ændringer";return React.createElement(reactBootstrap.Modal,{show:t,onHide:this.closeHandle.bind(this),bsSize:"lg"},React.createElement("form",null,React.createElement(reactBootstrap.Modal.Header,{closeButton:!0},React.createElement(reactBootstrap.Modal.Title,null,n)),React.createElement(reactBootstrap.Modal.Body,null,React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lg:12},React.createElement(reactBootstrap.FormGroup,{controlId:"formPostTitle",validationState:this.getValidation()},React.createElement(reactBootstrap.ControlLabel,null,"Overskrift"),React.createElement(reactBootstrap.FormControl,{type:"text",placeholder:"Overskrift på indlæg...",onChange:this.handleTitleChange.bind(this),value:this.state.Title})),React.createElement(reactBootstrap.FormGroup,{controlId:"formPostContent"},React.createElement(reactBootstrap.ControlLabel,null,"Indlæg"),React.createElement(reactBootstrap.FormControl,{componentClass:"textarea",placeholder:"Skriv besked her...",onChange:this.handleTextChange.bind(this),value:this.state.Text,rows:"8"})),React.createElement(reactBootstrap.FormGroup,{controlId:"formPostSticky"},React.createElement(reactBootstrap.ButtonGroup,null,React.createElement(reactBootstrap.Button,{bsStyle:"success",bsSize:"small",active:this.state.Sticky,onClick:this.handleSticky.bind(this)},React.createElement(reactBootstrap.Glyphicon,{glyph:"pushpin"})," Vigtig")))))),React.createElement(reactBootstrap.Modal.Footer,null,React.createElement(reactBootstrap.Button,{bsStyle:"default",onClick:this.closeHandle.bind(this)},"Luk"),React.createElement(reactBootstrap.Button,{bsStyle:"primary",type:"submit",onClick:this.handleSubmit},a))))},t}(React.Component),CommentControls=function(e){function t(t){e.call(this,t),this.state={text:t.text,replyText:"",reply:!1,edit:!1},this.toggleEdit=this.toggleEdit.bind(this),this.toggleReply=this.toggleReply.bind(this),this.editHandle=this.editHandle.bind(this),this.replyHandle=this.replyHandle.bind(this),this.deleteHandle=this.deleteHandle.bind(this),this.handleTextChange=this.handleTextChange.bind(this),this.handleReplyChange=this.handleReplyChange.bind(this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.handleTextChange=function(e){this.setState({text:e.target.value})},t.prototype.handleReplyChange=function(e){this.setState({replyText:e.target.value})},t.prototype.toggleEdit=function(){var e=this.state,t=e.edit;if(this.setState({edit:!t}),!t){var r=this.props,o=r.text;this.setState({text:o})}},t.prototype.toggleReply=function(){var e=this.state,t=e.reply;this.setState({reply:!t})},t.prototype.deleteHandle=function(){var e=this.props,t=e.deleteComment,r=e.commentId,o=e.contextId;t(r,o)},t.prototype.editHandle=function(){var e=this.props,t=e.editComment,r=e.contextId,o=e.commentId,n=this.state,a=n.text;this.setState({edit:!1}),t(o,r,a)},t.prototype.replyHandle=function(){var e=this.props,t=e.commentId,r=e.contextId,o=e.replyComment,n=this.state,a=n.replyText;this.setState({reply:!1,replyText:""}),o(r,a,t)},t.prototype.render=function(){var e=this.props,t=(e.commentId,e.authorId),r=e.canEdit,o=this.state,n=o.edit,a=o.text,s=o.reply,c=o.replyText,i=r(t);return React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Row,{style:{paddingBottom:"5px",paddingLeft:"15px"}},React.createElement(reactBootstrap.Col,{lg:4},React.createElement(reactBootstrap.ButtonToolbar,null,React.createElement(reactBootstrap.ButtonGroup,null,React.createElement(ButtonTooltip,{bsStyle:"primary",onClick:this.deleteHandle,icon:"trash",tooltip:"slet",mount:i}),React.createElement(ButtonTooltip,{bsStyle:"primary",onClick:this.toggleEdit,icon:"pencil",tooltip:"ændre",active:n,mount:i}),React.createElement(ButtonTooltip,{bsStyle:"primary",onClick:this.toggleReply,icon:"envelope",tooltip:"svar",active:s,mount:!0}))))),React.createElement(reactBootstrap.Row,{style:{paddingBottom:"5px"}},React.createElement(reactBootstrap.Col,{lgOffset:1,lg:10},React.createElement(CollapseTextArea,{show:n,id:"editTextControl",value:a,onChange:this.handleTextChange,toggle:this.toggleEdit,save:this.editHandle,saveText:"Gem ændringer",mount:i}))),React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lgOffset:1,lg:10},React.createElement(CollapseTextArea,{show:s,id:"replyTextControl",value:c,onChange:this.handleReplyChange,toggle:this.toggleReply,save:this.replyHandle,saveText:"Svar",mount:!0}))))},t}(React.Component),CollapseTextArea=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(){var e=this.props,t=e.show,r=e.id,o=e.value,n=e.onChange,a=e.toggle,s=e.save,c=e.saveText,i=e.mount;return i?React.createElement(reactBootstrap.Collapse,{in:t},React.createElement(reactBootstrap.FormGroup,{controlId:r},React.createElement(reactBootstrap.FormControl,{componentClass:"textarea",value:o,onChange:n,rows:"4"}),React.createElement("br",null),React.createElement(reactBootstrap.ButtonToolbar,null,React.createElement(reactBootstrap.Button,{onClick:a},"Luk"),React.createElement(reactBootstrap.Button,{type:"submit",bsStyle:"info",onClick:s},c)))):null},t}(React.Component),ButtonTooltip=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(){var e=this.props,t=e.tooltip,r=e.onClick,o=e.icon,n=e.bsStyle,a=e.active,s=e.mount,c=React.createElement(reactBootstrap.Tooltip,{id:"tooltip"},t);return s?React.createElement(reactBootstrap.OverlayTrigger,{placement:"top",overlay:c},React.createElement(reactBootstrap.Button,{bsStyle:n,bsSize:"xsmall",onClick:r,active:a},React.createElement(reactBootstrap.Glyphicon,{glyph:o}))):null},t}(React.Component),updateThreadTitle=function(e){return{type:UPDATE_THREAD_TITLE,id:e.ID,title:e}},setThreadTitles=function(e){return{type:SET_THREAD_TITLES,titles:e}},setTotalPages$1=function(e){return{type:SET_TOTAL_PAGES_THREADS,totalPages:e}},setPage$1=function(e){return{type:SET_PAGE_THREADS,page:e}},setSkip=function(e){return{type:SET_SKIP_THREADS,skip:e}},setTake$1=function(e){return{type:SET_TAKE_THREADS,take:e}},setSelectedThread=function(e){return{type:SET_SELECTEDTHREAD_ID,id:e}},setPostContent=function(e){return{type:SET_POST_CONTENT,content:e}},markPost=function(e,t,r){return function(o){var n=globals.urls.forumpost+"?postId="+e+"&read="+t,a=Object.assign({},options,{method:"PUT"});return fetch(n,a).then(r,onReject)}},fetchThreads=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=10),function(r){var o=globals.urls.forumtitle,n=o+"?skip="+e+"&take="+t,a=responseHandler.bind(this,r);return fetch(n,options).then(a).then(function(o){var n=o.CurrentItems,a=n.map(normalizeThreadTitle);r(setSkip(e)),r(setTake$1(t)),r(setTotalPages$1(o.TotalPages)),r(setPage$1(o.CurrentPage)),r(setThreadTitles(a))},onReject)}},fetchPost=function(e,t){return function(r){var o=globals.urls.forumpost,n=o+"?id="+e,a=responseHandler.bind(this,r);return fetch(n,options).then(a).then(function(e){var t=e.Text,o=normalizeThreadTitle(e.Header);r(updateThreadTitle(o)),r(setPostContent(t)),r(setSelectedThread(e.ThreadID))}).then(t)}},updatePost=function(e,t,r){return function(o){var n=globals.urls.forumpost+"?id="+e,a=new Headers;a.append("Content-Type","application/json");var s=(responseHandler.bind(this,o),Object.assign({},options,{method:"PUT",body:JSON.stringify(t),headers:a}));return fetch(n,s).then(r,onReject)}},deletePost=function(e,t){return function(r){var o=globals.urls.forumpost+"?id="+e,n=Object.assign({},options,{method:"DELETE"});responseHandler.bind(this,r);return fetch(o,n).then(t,onReject)}},postThread=function(e,t){return function(r){var o=globals.urls.forumpost,n=new Headers;n.append("Content-Type","application/json");var a=Object.assign({},options,{method:"POST",body:JSON.stringify(t),headers:n});return fetch(o,a).then(function(){return e()},onReject)}},this$1=void 0,setSkipComments=function(e){return{type:SET_SKIP_COMMENTS,skip:e}},setTakeComments=function(e){return{type:SET_TAKE_COMMENTS,take:e}},postComment=function(e,t,r,o,n){return function(a){var s=new Headers;s.append("Content-Type","application/json");var c=JSON.stringify({Text:r,ContextID:t,ParentID:o}),i=Object.assign({},options,{method:"POST",body:c,headers:s});return fetch(e,i).then(n,onReject)}},editComment=function(e,t,r,o){return function(n,a){var s=new Headers;s.append("Content-Type","application/json");var c=Object.assign({},options,{method:"PUT",body:JSON.stringify({ID:t,Text:r}),headers:s});return fetch(e,c).then(o,onReject)}},deleteComment=function(e,t){return function(r,o){var n=Object.assign({},options,{method:"DELETE"});return fetch(e,n).then(t)}},fetchAndFocusSingleComment=function(e){return function(t,r){var o=globals.urls.imagecomments+"/GetSingle?id="+e,n=responseHandler.bind(this$1,t);return fetch(o,options).then(n).then(function(e){var r=normalizeComment(e);t(receivedComments([r])),t(setFocusedComment(r.CommentID))},onReject)}},mapStateToProps$3=function(e){var t=e.forumInfo.titlesInfo.selectedThread,r=underscore.find(e.forumInfo.titlesInfo.titles,function(e){return e.ID==t});return{selected:t,title:r,text:e.forumInfo.postContent,getUser:function(t){return e.usersInfo.users[t]},canEdit:function(t){return e.usersInfo.currentUserId==t},hasRead:!!r&&underscore.contains(r.ViewedBy,e.usersInfo.currentUserId)}},mapDispatchToProps$3=function(e){return{update:function(t,r,o){e(updatePost(t,r,o))},getPost:function(t){e(fetchPost(t))},deletePost:function(t,r){e(deletePost(t,r))},readPost:function(t,r,o){e(markPost(t,r,o))}}},ForumPostContainer=function(e){function t(t){e.call(this,t),this.state={edit:!1},this.toggleEdit=this.toggleEdit.bind(this),this.onSubmit=this.onSubmit.bind(this),this.deleteHandle=this.deleteHandle.bind(this),this.togglePostRead=this.togglePostRead.bind(this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.componentWillReceiveProps=function(e){var t=Boolean(e.title);t&&(this.setState({model:{Title:e.title.Title,Text:e.text,Sticky:e.title.Sticky,IsPublished:e.title.IsPublished}}),document.title=e.title.Title)},t.prototype.deleteHandle=function(){var e=this.props,t=e.router,r=e.deletePost,o=e.title,n=function(){var e="/forum";t.push(e)};r(o.ID,n)},t.prototype.toggleEdit=function(){var e=this.state.edit;this.setState({edit:!e})},t.prototype.onSubmit=function(e){var t=this.props,r=t.update,o=t.getPost,n=t.title,a=function(){o(n.ID)};r(n.ID,e,a)},t.prototype.togglePostRead=function(e){var t=this.props,r=t.getPost,o=t.readPost,n=t.title,a=function(){r(n.ID)};o(n.ID,e,a)},t.prototype.close=function(){this.setState({edit:!1})},t.prototype.render=function(){var e=this.props,t=e.canEdit,r=e.selected,o=e.title,n=e.text,a=e.getUser,s=e.hasRead;if(r<0||!o)return null;var c=t(o.AuthorID),i=a(o.AuthorID),l=getFullName(i);
return React.createElement(reactBootstrap.Row,null,React.createElement(ForumHeader,{lg:12,name:l,title:o.Title,createdOn:o.CreatedOn,modifiedOn:o.LastModified},React.createElement(ForumButtonGroup,{show:!0,editable:c,initialRead:s,onDelete:this.deleteHandle,onEdit:this.toggleEdit,onRead:this.togglePostRead.bind(this,!0),onUnread:this.togglePostRead.bind(this,!1)})),React.createElement(ForumBody,{text:n,lg:10},React.createElement("hr",null),this.props.children),React.createElement(ForumForm,{show:this.state.edit,close:this.close.bind(this),onSubmit:this.onSubmit.bind(this),edit:this.state.model}))},t}(React.Component),ForumBody=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(){var e=this.props,t=e.text,r=e.lg,o=e.lgOffset,n=formatText(t);return React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lg:r,lgOffset:o},React.createElement("p",{className:"forum-content",dangerouslySetInnerHTML:n}),React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lg:12},this.props.children))))},t}(React.Component);ForumBody.propTypes={text:React.PropTypes.string.isRequired,lg:React.PropTypes.number,lgOffset:React.PropTypes.number};var ForumHeader=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getCreatedOnText=function(e,t){var r=moment(e),o=r.format("D-MM-YY"),n=r.format(" H:mm");if(!t)return"Udgivet "+o+" kl. "+n;var a=moment(t),s=a.format("D-MM-YY"),c=a.format("H:mm");return"Udgivet "+o+" kl. "+n+" ( rettet "+s+" kl. "+c+" )"},t.prototype.render=function(){var e=this.props,t=e.title,r=e.name,o=e.createdOn,n=e.modifiedOn,a=e.lg,s=e.lgOffset,c=this.getCreatedOnText(o,n),i={lg:a,lgOffset:s};return React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,i,React.createElement("h3",null,React.createElement("span",{className:"text-capitalize"},t),React.createElement("br",null),React.createElement("small",null,"Skrevet af ",r)),React.createElement("small",{className:"text-primary"},React.createElement(reactBootstrap.Glyphicon,{glyph:"time"})," ",c),React.createElement(reactBootstrap.Row,null,this.props.children)))},t}(React.Component);ForumHeader.propTypes={createdOn:React.PropTypes.string,modifiedOn:React.PropTypes.string,title:React.PropTypes.string.isRequired,name:React.PropTypes.string.isRequired};var ForumButtonGroup=function(e){function t(e){this.state={read:e.initialRead},this.readHandle=this.readHandle.bind(this),this.unreadHandle=this.unreadHandle.bind(this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.readHandle=function(){var e=this.props,t=e.onRead;this.state.read||(this.setState({read:!0}),t())},t.prototype.unreadHandle=function(){var e=this.props,t=e.onUnread;this.state.read&&(this.setState({read:!1}),t())},t.prototype.render=function(){var e=this.props,t=e.editable,r=e.show,o=e.onDelete,n=e.onEdit;if(!r)return null;var a=this.state,s=a.read;return React.createElement(reactBootstrap.Col,{lg:12,className:"forum-editbar"},React.createElement(reactBootstrap.ButtonToolbar,null,React.createElement(reactBootstrap.ButtonGroup,null,React.createElement(ButtonTooltip,{bsStyle:"danger",onClick:o,icon:"trash",tooltip:"slet indlæg",mount:t}),React.createElement(ButtonTooltip,{bsStyle:"primary",onClick:n,icon:"pencil",tooltip:"ændre indlæg",active:!1,mount:t}),React.createElement(ButtonTooltip,{bsStyle:"primary",onClick:this.readHandle,icon:"eye-open",tooltip:"marker som læst",active:s,mount:!0}),React.createElement(ButtonTooltip,{bsStyle:"primary",onClick:this.unreadHandle,icon:"eye-close",tooltip:"marker som ulæst",active:!s,mount:!0}))))},t}(React.Component);ForumButtonGroup.propTypes={show:React.PropTypes.bool.isRequired,editable:React.PropTypes.bool.isRequired,initialRead:React.PropTypes.bool.isRequired,onDelete:React.PropTypes.func.isRequired,onEdit:React.PropTypes.func.isRequired,onRead:React.PropTypes.func.isRequired,onUnread:React.PropTypes.func.isRequired};var ForumPostRedux=reactRedux.connect(mapStateToProps$3,mapDispatchToProps$3)(ForumPostContainer),ForumPost=reactRouter.withRouter(ForumPostRedux),Pagination$1=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(){var e=this.props,t=e.totalPages,r=e.page,o=e.pageHandle,n=e.show,a=t>1,s=(n||a)&&!(n&&a);return s||n&&a?React.createElement(reactBootstrap.Pagination,{prev:!0,next:!0,ellipsis:!0,boundaryLinks:!0,items:t,maxButtons:5,activePage:r,onSelect:o}):null},t}(React.Component),mapStateToProps$2=function(e){return{items:e.whatsNewInfo.items,getUser:function(t){return e.usersInfo.users[t]},skip:e.whatsNewInfo.skip,take:e.whatsNewInfo.take,totalPages:e.whatsNewInfo.totalPages,page:e.whatsNewInfo.page}},mapDispatchToProps$2=function(e){return{getLatest:function(t,r){return e(fetchLatestNews(t,r))}}},WhatsNewContainer=function(e){function t(t){e.call(this,t),this.state={modal:!1,postPreview:null,author:{},on:null},this.pageHandle=this.pageHandle.bind(this),this.previewPost=this.previewPost.bind(this),this.closeModal=this.closeModal.bind(this),this.modalView=this.modalView.bind(this),this.navigateTo=this.navigateTo.bind(this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.pageHandle=function(e){var t=this.props,r=t.getLatest,o=t.page,n=t.take;if(o!=e){var a=e-1,s=a*n;r(s,n)}},t.prototype.previewPost=function(e){var t=this.props,r=t.getUser,o=r(e.AuthorID);this.setState({modal:!0,postPreview:e.Item,author:o,on:e.On})},t.prototype.navigateTo=function(e){var t=this.props.router,r=t.push;r(e)},t.prototype.closeModal=function(){this.setState({modal:!1,postPreview:null,author:{},on:null})},t.prototype.modalView=function(){var e=this;if(!Boolean(this.state.postPreview))return null;var t=this.state.postPreview,r=t.Text,o=t.Title,n=t.ID,a=this.state.author,s=a.FirstName+" "+a.LastName,c="forum/post/"+n+"/comments";return React.createElement(reactBootstrap.Modal,{show:this.state.modal,onHide:this.closeModal,bsSize:"large"},React.createElement(reactBootstrap.Modal.Header,{closeButton:!0},React.createElement(reactBootstrap.Modal.Title,null,React.createElement(ForumHeader,{lg:11,lgOffset:1,createdOn:this.state.on,title:o,name:s}))),React.createElement(reactBootstrap.Modal.Body,null,React.createElement(ForumBody,{text:r,lg:11,lgOffset:1})),React.createElement(reactBootstrap.Modal.Footer,null,React.createElement(reactBootstrap.ButtonToolbar,{style:{float:"right"}},React.createElement(reactBootstrap.Button,{bsStyle:"primary",onClick:function(){return e.navigateTo(c)}},"Se kommentarer (forum)"),React.createElement(reactBootstrap.Button,{onClick:this.closeModal},"Luk"))))},t.prototype.render=function(){var e=this.props,t=e.items,r=e.getUser,o=e.totalPages,n=e.page;return React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,null,React.createElement("h3",null,"Sidste hændelser"),React.createElement("hr",null),React.createElement(WhatsNewList,{items:t,getUser:r,preview:this.previewPost}),React.createElement(Pagination$1,{totalPages:o,page:n,pageHandle:this.pageHandle}),this.modalView()))},t}(React.Component),WhatsNew=reactRouter.withRouter(reactRedux.connect(mapStateToProps$2,mapDispatchToProps$2)(WhatsNewContainer)),ImageUpload=function(e){function t(t){e.call(this,t),this.handleSubmit=this.handleSubmit.bind(this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.clearInput=function(e){if(e.value){try{e.value=""}catch(e){}if(e.value){var t=document.createElement("form"),r=e.parentNode,o=e.nextSibling;t.appendChild(e),t.reset(),r.insertBefore(e,o)}}},t.prototype.getFiles=function(){var e=document.getElementById("files");return e?e.files:[]},t.prototype.handleSubmit=function(e){var t=this.props,r=t.uploadImage,o=t.username;e.preventDefault();var n=this.getFiles();if(0!=n.length){for(var a=new FormData,s=0;s<n.length;s++){var c=n[s];a.append("file",c)}r(o,a);var i=document.getElementById("files");this.clearInput(i)}},t.prototype.render=function(){return React.createElement("form",{onSubmit:this.handleSubmit,id:"form-upload",encType:"multipart/form-data"},React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"files"},"Upload filer:"),React.createElement("input",{type:"file",className:"form-control",id:"files",name:"files",multiple:!0})),React.createElement(reactBootstrap.Button,{bsStyle:"primary",type:"submit"},"Upload"),this.props.children)},t}(React.Component),setSelectedImg=function(e){return{type:SET_SELECTED_IMG,id:e}},incrementCommentCount=function(e){return{type:INCR_IMG_COMMENT_COUNT,key:e}},decrementCommentCount=function(e){return{type:DECR_IMG_COMMENT_COUNT,key:e}},fetchSpaceInfo=function(e){return function(t){var r=responseHandler.bind(this,t);return fetch(e,options).then(r).then(function(e){var r=e.UsedSpaceKB,o=e.SpaceQuotaKB;t(setUsedSpacekB(r)),t(setTotalSpacekB(o))},onReject)}},mapStateToProps$4=function(e){return{usedMB:e.statusInfo.spaceInfo.usedSpacekB/1e3,totalMB:e.statusInfo.spaceInfo.totalSpacekB/1e3,loaded:e.statusInfo.spaceInfo.totalSpacekB!=-1}},mapDispatchToProps$4=function(e){return{getSpaceInfo:function(t){e(fetchSpaceInfo(t))}}},UsedSpaceView=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.componentDidMount=function(){var e=this.props,t=e.getSpaceInfo,r=globals.urls.diagnostics+"/getspaceinfo";t(r)},t.prototype.render=function(){var e=this.props,t=e.usedMB,r=e.totalMB,o=Math.round(r),n=Math.round(100*t)/100,a=Math.round(100*(o-n))/100,s=n/o*100,c=Math.round(100*s)/100,i=Boolean(s)&&Boolean(n)&&Boolean(a)&&Boolean(o);return i?React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,null,React.createElement(reactBootstrap.ProgressBar,{striped:!0,bsStyle:"success",now:s,key:1}),React.createElement("p",null,"Brugt: ",n.toString()," MB (",c.toString()," %)",React.createElement("br",null),"Fri plads: ",a.toString()," MB",React.createElement("br",null),"Total: ",o.toString()," MB"))):null},t}(React.Component),UsedSpace=reactRedux.connect(mapStateToProps$4,mapDispatchToProps$4)(UsedSpaceView),mapStateToProps$1=function(e){var t=underscore.values(e.usersInfo.users).filter(function(e){return e.Username.toUpperCase()==globals.currentUsername.toUpperCase()})[0],r=t?t.FirstName:"User";return{name:r,skip:e.whatsNewInfo.skip,take:e.whatsNewInfo.take}},mapDispatchToProps$1=function(e){return{uploadImage:function(t,r,o,n){var a=function(){e(fetchLatestNews(t,r))};e(uploadImage(o,n,a,function(){}))}}},HomeView=function(e){function t(t){e.call(this,t),this.state={recommended:!0},this.upload=this.upload.bind(this),this.recommendedView=this.recommendedView.bind(this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.componentDidMount=function(){document.title="Forside"},t.prototype.upload=function(e,t){var r=this.props,o=r.uploadImage,n=r.skip,a=r.take;o(n,a,e,t)},t.prototype.recommendedView=function(){var e=this;return this.state.recommended?React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,null,React.createElement(reactBootstrap.Alert,{bsStyle:"success",onDismiss:function(){return e.setState({recommended:!1})}},React.createElement("h4",null,"Anbefalinger"),React.createElement("ul",null,React.createElement("li",null,"Testet med Google Chrome browser. Derfor er det anbefalet at bruge denne til at få den fulde oplevelse.",React.createElement("br",null)))))):null},t.prototype.render=function(){var e=globals.currentUsername,t=this.props,r=t.name;return React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Jumbotron,null,React.createElement("h1",null,React.createElement("span",null,"Velkommen ",React.createElement("small",null,r,"!"))),React.createElement("p",{className:"lead"},"Til Inuplans intranet side"),React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lg:4},React.createElement(reactBootstrap.Panel,{header:"Du kan uploade billeder til dit eget galleri her",bsStyle:"primary"},React.createElement(ImageUpload,{username:e,uploadImage:this.upload}))))),React.createElement(reactBootstrap.Grid,{fluid:!0},React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lg:2}),React.createElement(reactBootstrap.Col,{lg:4},React.createElement(WhatsNew,null)),React.createElement(reactBootstrap.Col,{lgOffset:1,lg:3},this.recommendedView(),React.createElement("h3",null,"Personlig upload forbrug"),React.createElement("hr",null),React.createElement("p",null,"Herunder kan du se hvor meget plads du har brugt og hvor meget fri plads der er tilbage. Gælder kun billede filer."),React.createElement(UsedSpace,null)))))},t}(React.Component),Home=reactRedux.connect(mapStateToProps$1,mapDispatchToProps$1)(HomeView),Forum=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(){return React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lgOffset:2,lg:8},React.createElement("h1",null,"Forum ",React.createElement("small",null,"indlæg")),React.createElement("hr",null),this.props.children))},t}(React.Component),ForumTitle=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.dateView=function(e){var t=moment(e).format("D/MM/YY");return""+t},t.prototype.modifiedView=function(e){if(!e)return null;var t=moment(e).format("D/MM/YY-H:mm");return""+t},t.prototype.tooltipView=function(){return React.createElement(reactBootstrap.Tooltip,{id:"tooltip"},"Vigtig")},t.prototype.stickyIcon=function(e){return e?React.createElement("p",{className:"sticky"},React.createElement(reactBootstrap.OverlayTrigger,{placement:"top",overlay:this.tooltipView()},React.createElement(reactBootstrap.Glyphicon,{glyph:"pushpin"}))):null},t.prototype.dateModifiedView=function(e){var t=this.dateView(e.CreatedOn),r=this.modifiedView(e.LastModified);if(!r)return React.createElement("span",null,t);return React.createElement("span",null,t,React.createElement("br",null),"(",r,")")},t.prototype.createSummary=function(){var e=this.props,t=e.title;if(!t.LatestComment)return"Ingen kommentarer";if(t.LatestComment.Deleted)return"Kommentar slettet";var r=t.LatestComment.Text;return getWords(r,5)},t.prototype.render=function(){var e=this.props,t=e.title,r=e.getAuthor,o=(e.onClick,r(t.AuthorID)),n=this.createSummary(),a=t.Sticky?"thread thread-pinned":"thread",s="/forum/post/"+t.ID+"/comments";return React.createElement(reactRouter.Link,{to:s},React.createElement(reactBootstrap.Row,{className:a},React.createElement(reactBootstrap.Col,{lg:1,className:"text-center"},this.stickyIcon(t.Sticky)),React.createElement(reactBootstrap.Col,{lg:5},React.createElement("h4",null,React.createElement("span",{className:"text-capitalize"},t.Title)),React.createElement("small",null,"Af: ",o)),React.createElement(reactBootstrap.Col,{lg:2,className:"text-left"},React.createElement("p",null,this.dateModifiedView(t))),React.createElement(reactBootstrap.Col,{lg:2,className:"text-center"},React.createElement("p",null,t.ViewedBy.length)),React.createElement(reactBootstrap.Col,{lg:2,className:"text-center"},React.createElement("p",null,n))))},t}(React.Component),mapStateToProps$5=function(e){return{threads:e.forumInfo.titlesInfo.titles,skip:e.forumInfo.titlesInfo.skip,take:e.forumInfo.titlesInfo.take,page:e.forumInfo.titlesInfo.page,totalPages:e.forumInfo.titlesInfo.totalPages,getAuthor:function(t){var r=e.usersInfo.users[t];return r.FirstName+" "+r.LastName}}},mapDispatchToProps$5=function(e){return{fetchThreads:function(t,r){e(fetchThreads(t,r))},postThread:function(t,r){e(postThread(t,r))},setSelectedThread:function(t){e(setSelectedThread(t))}}},ForumListContainer=function(e){function t(t){e.call(this,t),this.state={newPost:!1},this.pageHandle=this.pageHandle.bind(this),this.close=this.close.bind(this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.componentDidMount=function(){document.title="Inuplan Forum"},t.prototype.pageHandle=function(e){var t=this.props,r=t.fetchThreads,o=t.page,n=t.take;if(o!=e){var a=(e-1)*n;r(a,n)}},t.prototype.threadViews=function(){var e=this.props,t=e.threads,r=e.getAuthor;e.setSelectedThread;return t.map(function(e){var t="thread_"+e.ID;return React.createElement(ForumTitle,{title:e,key:t,getAuthor:r})})},t.prototype.submit=function(e){var t=this.props,r=t.postThread,o=t.fetchThreads,n=t.skip,a=t.take;r(function(){return o(n,a)},e)},t.prototype.close=function(){this.setState({newPost:!1})},t.prototype.show=function(){this.setState({newPost:!0})},t.prototype.render=function(){var e=this.props,t=e.totalPages,r=e.page;return React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.ButtonGroup,null,React.createElement(reactBootstrap.Button,{bsStyle:"primary",onClick:this.show.bind(this)},"Tilføj nyt indlæg")),React.createElement(reactBootstrap.Col,{lg:12},React.createElement(reactBootstrap.Row,{className:"thread-head"},React.createElement(reactBootstrap.Col,{lg:1},React.createElement("strong",null,"Info")),React.createElement(reactBootstrap.Col,{lg:5},React.createElement("strong",null,"Overskrift")),React.createElement(reactBootstrap.Col,{lg:2,className:"text-center"},React.createElement("strong",null,"Dato")),React.createElement(reactBootstrap.Col,{lg:2,className:"text-center"},React.createElement("strong",null,"Læst af")),React.createElement(reactBootstrap.Col,{lg:2,className:"text-center"},React.createElement("strong",null,"Seneste kommentar"))),this.threadViews(),React.createElement(Pagination$1,{totalPages:t,page:r,pageHandle:this.pageHandle,show:!0})),React.createElement(ForumForm,{show:this.state.newPost,close:this.close.bind(this),onSubmit:this.submit.bind(this)}))},t}(React.Component),ForumList=reactRedux.connect(mapStateToProps$5,mapDispatchToProps$5)(ForumListContainer),CommentDeleted=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(){var e=this.props,t=e.replies,r=e.construct,o=t.map(function(e){return r(e)});return React.createElement(reactBootstrap.Media,null,React.createElement(reactBootstrap.Media.Left,{style:{minWidth:"74px"}}),React.createElement(reactBootstrap.Media.Body,null,React.createElement("p",{className:"text-muted comment-deleted"},React.createElement("span",null,React.createElement(reactBootstrap.Glyphicon,{glyph:"remove-sign"})," Kommentar slettet")),o))},t}(React.Component),Comment=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.ago=function(){var e=this.props,t=e.postedOn;return timeText(t)},t.prototype.editedView=function(e){return e?React.createElement("span",null,"*"):null},t.prototype.render=function(){var e=this.props,t=e.canEdit,r=e.contextId,o=e.name,n=e.text,a=e.commentId,s=e.replies,c=e.construct,i=e.authorId,l=e.edited,p=this.props,m=(p.skip,p.take,p.editComment,p.deleteComment,p.replyComment,formatText(n)),u=s.map(function(e){return c(e)});return React.createElement(reactBootstrap.Media,null,React.createElement(CommentProfile,null),React.createElement(reactBootstrap.Media.Body,null,React.createElement("h5",{className:"media-heading"},React.createElement("strong",null,o)," ",React.createElement("small",null,"sagde ",this.ago(),this.editedView(l))),React.createElement("span",{dangerouslySetInnerHTML:m}),React.createElement(CommentControls,{contextId:r,canEdit:t,authorId:i,commentId:a,text:n,props:!0}),u))},t}(React.Component);Comment.propTypes={contextId:React.PropTypes.number.isRequired,name:React.PropTypes.string.isRequired,text:React.PropTypes.string.isRequired,commentId:React.PropTypes.number.isRequired,replies:React.PropTypes.arrayOf(React.PropTypes.object),construct:React.PropTypes.func,authorId:React.PropTypes.number.isRequired,canEdit:React.PropTypes.func.isRequired,edited:React.PropTypes.bool.isRequired,skip:React.PropTypes.number,take:React.PropTypes.number,editComment:React.PropTypes.func.isRequired,deleteComment:React.PropTypes.func.isRequired,replyComment:React.PropTypes.func.isRequired};var CommentList=function(e){function t(t){e.call(this,t),this.constructComment=this.constructComment.bind(this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.rootComments=function(e){var t=this;if(e)return e.map(function(e){var r=t.constructComment(e);return React.createElement(reactBootstrap.Media.ListItem,{key:"rootComment_"+e.CommentID},r)})},t.prototype.constructComment=function(e){var t="commentId"+e.CommentID;if(e.Deleted)return React.createElement(CommentDeleted,{key:t,construct:this.constructComment,replies:e.Replies});var r=this.props,o=r.contextId,n=r.getName,a=r.canEdit,s=this.props,c=(s.skip,s.take,s.editComment,s.deleteComment,s.replyComment,n(e.AuthorID));return React.createElement(Comment,{key:t,contextId:o,name:c,postedOn:e.PostedOn,authorId:e.AuthorID,text:e.Text,construct:this.constructComment,replies:e.Replies,edited:e.Edited,canEdit:a,commentId:e.CommentID,props:!0})},t.prototype.render=function(){var e=this.props,t=e.comments,r=this.rootComments(t);return React.createElement(reactBootstrap.Media.List,null,r)},t}(React.Component);CommentList.propTypes={comments:React.PropTypes.arrayOf(React.PropTypes.object),contextId:React.PropTypes.number,getName:React.PropTypes.func,canEdit:React.PropTypes.func,skip:React.PropTypes.number,take:React.PropTypes.number,editComment:React.PropTypes.func.isRequired,deleteComment:React.PropTypes.func.isRequired,replyComment:React.PropTypes.func.isRequired};var CommentForm=function(e){function t(t){e.call(this,t),this.state={Text:""},this.postComment=this.postComment.bind(this),this.handleTextChange=this.handleTextChange.bind(this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.postComment=function(e){e.preventDefault();var t=this.props,r=t.postHandle;r(this.state.Text),this.setState({Text:""})},t.prototype.handleTextChange=function(e){this.setState({Text:e.target.value})},t.prototype.render=function(){return React.createElement("form",{onSubmit:this.postComment},React.createElement("label",{htmlFor:"remark"},"Kommentar"),React.createElement("textarea",{className:"form-control",onChange:this.handleTextChange,value:this.state.Text,placeholder:"Skriv kommentar her...",id:"remark",rows:"4"}),React.createElement("br",null),React.createElement("button",{type:"submit",className:"btn btn-primary"},"Send"))},t}(React.Component);CommentForm.propTypes={postHandle:React.PropTypes.func.isRequired};var mapStateToProps$6=function(e){return{comments:e.commentsInfo.comments,getName:function(t){var r=e.usersInfo.users[t];return r?r.FirstName+" "+r.LastName:""},canEdit:function(t){return e.usersInfo.currentUserId==t},postId:e.forumInfo.titlesInfo.selectedThread,page:e.commentsInfo.page,skip:e.commentsInfo.skip,take:e.commentsInfo.take,totalPages:e.commentsInfo.totalPages}},mapDispatchToProps$6=function(e){return{editHandle:function(t,r,o,n){var a=globals.urls.forumcomments;e(editComment(a,t,o,n))},deleteHandle:function(t,r){var o=getForumCommentsDeleteUrl(t);e(deleteComment(o,r))},replyHandle:function(t,r,o,n){var a=globals.urls.forumcomments;e(postComment(a,t,r,o,n))},loadComments:function(t,r,o){var n=getForumCommentsPageUrl(t,r,o);e(fetchComments(n,r,o))},postHandle:function(t,r,o){var n=globals.urls.forumcomments;e(postComment(n,t,r,null,o))}}},ForumCommentsContainer=function(e){function t(t){e.call(this,t),this.deleteComment=this.deleteComment.bind(this),this.editComment=this.editComment.bind(this),this.replyComment=this.replyComment.bind(this),this.postComment=this.postComment.bind(this),this.pageHandle=this.pageHandle.bind(this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.componentWillReceiveProps=function(e){var t=this.props,r=t.loadComments,o=t.postId,n=(t.skip,t.take),a=e.location.query,s=a.page;if(Number(s)){var c=s-1,i=c*n;r(o,i,n)}},t.prototype.pageHandle=function(e){var t=this.props,r=t.postId,o=t.page,n=this.props.router,a=n.push;if(o!=e){var s="/forum/post/"+r+"/comments?page="+e;a(s)}},t.prototype.deleteComment=function(e,t){var r=this.props,o=r.deleteHandle,n=r.loadComments,a=r.skip,s=r.take,c=function(){n(t,a,s)};o(e,c)},t.prototype.editComment=function(e,t,r){var o=this.props,n=o.editHandle,a=o.loadComments,s=o.skip,c=o.take,i=function(){a(t,s,c)};n(e,t,r,i)},t.prototype.replyComment=function(e,t,r){var o=this.props,n=o.replyHandle,a=o.loadComments,s=o.skip,c=o.take,i=function(){a(e,s,c)};n(e,t,r,i)},t.prototype.postComment=function(e){var t=this.props,r=t.loadComments,o=t.postId,n=t.skip,a=t.take,s=t.postHandle,c=function(){r(o,n,a)};s(o,e,c)},t.prototype.render=function(){var e=this.props,t=e.comments,r=e.getName,o=e.canEdit,n=e.totalPages,a=e.page,s=this.props.params,c=s.id,i=this.props,l=i.skip,p=i.take,m={skip:l,take:p};return m=Object.assign({},m,{deleteComment:this.deleteComment,editComment:this.editComment,replyComment:this.replyComment}),React.createElement(reactBootstrap.Row,{className:"forum-comments-list"},React.createElement("h4",{className:"forum-comments-heading"},"Kommentarer"),React.createElement(CommentList,{comments:t,contextId:Number(c),getName:r,canEdit:o,props:!0}),React.createElement(Pagination$1,{totalPages:n,page:a,pageHandle:this.pageHandle}),React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lg:12},React.createElement("hr",null),React.createElement(CommentForm,{postHandle:this.postComment}),React.createElement("br",null))))},t}(React.Component),ForumCommentsContainerRedux=reactRedux.connect(mapStateToProps$6,mapDispatchToProps$6)(ForumCommentsContainer),ForumComments=reactRouter.withRouter(ForumCommentsContainerRedux),User=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(){var e=this.props,t=e.username,r=e.firstName,o=e.lastName,n=e.email,a="mailto:"+n,s="/"+t+"/gallery";return React.createElement(reactBootstrap.Col,{lg:3},React.createElement(reactBootstrap.Panel,{header:r+" "+o},React.createElement(UserItem,{title:"Brugernavn"},t),React.createElement(UserItem,{title:"Email"},React.createElement("a",{href:a},n)),React.createElement(UserItem,{title:"Billeder"},React.createElement(reactRouter.Link,{to:s},"Billeder"))))},t}(React.Component),UserHeading=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(){return React.createElement(reactBootstrap.Col,{lg:6},React.createElement("strong",null,this.props.children))},t}(React.Component),UserBody=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(){return React.createElement(reactBootstrap.Col,{lg:6},this.props.children)},t}(React.Component),UserItem=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(){var e=this.props,t=e.title;return React.createElement(reactBootstrap.Row,null,React.createElement(UserHeading,null,t),React.createElement(UserBody,null,this.props.children))},t}(React.Component),UserList=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.userNodes=function(){var e=this.props,t=e.users;return t.map(function(e){var t="userId_"+e.ID;return React.createElement(User,{username:e.Username,userId:e.ID,firstName:e.FirstName,lastName:e.LastName,email:e.Email,profileUrl:e.ProfileImage,roles:e.Roles,key:t})})},t.prototype.render=function(){return React.createElement(reactBootstrap.Row,null,this.userNodes())},t}(React.Component),Breadcrumb=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(){return React.createElement("ol",{className:"breadcrumb"},this.props.children)},t}(React.Component);Breadcrumb.Item=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(){var e=this.props,t=e.href,r=e.active;return r?React.createElement("li",{className:"active"},this.props.children):React.createElement("li",null,React.createElement(reactRouter.Link,{to:t},this.props.children))},t}(React.Component);var mapUsersToProps=function(e){return{users:underscore.values(e.usersInfo.users)}},mapDispatchToProps$7=function(e){return{getUsers:function(){e(fetchUsers())}}},UsersContainer=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.componentDidMount=function(){document.title="Brugere"},t.prototype.render=function(){var e=this.props,t=e.users;return React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lgOffset:2,lg:8},React.createElement(Breadcrumb,null,React.createElement(Breadcrumb.Item,{href:"/"},"Forside"),React.createElement(Breadcrumb.Item,{active:!0},"Brugere")))),React.createElement(reactBootstrap.Col,{lgOffset:2,lg:8},React.createElement(reactBootstrap.PageHeader,null,"Inuplan's ",React.createElement("small",null,"brugere")),React.createElement(reactBootstrap.Row,null,React.createElement(UserList,{users:t}))))},t}(React.Component),Users=reactRedux.connect(mapUsersToProps,mapDispatchToProps$7)(UsersContainer),Image$1=function(e){function t(t){e.call(this,t),this.checkboxHandler=this.checkboxHandler.bind(this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.checkboxHandler=function(e){var t=this.props,r=t.image,o=e.currentTarget.checked;if(o){var n=this.props,a=n.addSelectedImageId;a(r.ImageID)}else{var s=this.props,c=s.removeSelectedImageId;c(r.ImageID)}},t.prototype.commentIcon=function(e){var t=0==e?"col-lg-6 text-muted":"col-lg-6 text-primary",r={className:t};return React.createElement("div",r,React.createElement("span",{className:"glyphicon glyphicon-comment","aria-hidden":"true"})," ",e)},t.prototype.checkboxView=function(){var e=this.props,t=e.canEdit,r=e.imageIsSelected,o=e.image,n=r(o.ImageID);return t?React.createElement(reactBootstrap.Col,{lg:6,className:"pull-right text-right"},React.createElement("label",null,"Slet ",React.createElement("input",{type:"checkbox",onClick:this.checkboxHandler,checked:n}))):null},t.prototype.render=function(){var e=this.props,t=e.image,r=e.username,o=t.CommentCount,n="/"+r+"/gallery/image/"+t.ImageID+"/comments";return React.createElement("div",null,React.createElement(reactRouter.Link,{to:n},React.createElement(reactBootstrap.Image,{src:t.PreviewUrl,thumbnail:!0})),React.createElement(reactBootstrap.Row,null,React.createElement(reactRouter.Link,{to:n},this.commentIcon(o)),this.checkboxView()))},t}(React.Component),elementsPerRow=4,ImageList=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),
t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.arrangeArray=function(e){for(var t=e.length,r=Math.ceil(t/elementsPerRow),o=[],n=0,a=0;a<r;a++){n=a*elementsPerRow;var s=n+elementsPerRow,c=s>t;if(c){var i=e.slice(n);o.push(i)}else{var l=e.slice(n,s);o.push(l)}}return o},t.prototype.imagesView=function(e){if(0==e.length)return null;var t=this.props,r=t.addSelectedImageId,o=t.removeSelectedImageId,n=(t.deleteSelectedImages,t.canEdit),a=t.imageIsSelected,s=t.username,c=this.arrangeArray(e),i=c.map(function(e,t){var c=e.map(function(e){return React.createElement(reactBootstrap.Col,{lg:3,key:e.ImageID},React.createElement(Image$1,{image:e,canEdit:n,addSelectedImageId:r,removeSelectedImageId:o,imageIsSelected:a,username:s}))}),i="rowId"+t;return React.createElement(reactBootstrap.Row,{key:i},c)});return i},t.prototype.render=function(){var e=this.props,t=e.images;return React.createElement(reactBootstrap.Row,null,this.imagesView(t))},t}(React.Component),mapStateToProps$7=function(e){var t=e.imagesInfo,r=t.ownerId,o=e.usersInfo.currentUserId,n=r>0&&o>0&&r==o,a=e.usersInfo.users[r],s=a?a.FirstName+" "+a.LastName:"",c=underscore.sortBy(underscore.values(e.imagesInfo.images),function(e){return-e.ImageID});return{images:c,canEdit:n,selectedImageIds:e.imagesInfo.selectedImageIds,fullName:s}},mapDispatchToProps$8=function(e){return{uploadImage:function(t,r){e(uploadImage(t,r,function(){e(fetchUserImages(t))},function(){}))},addSelectedImageId:function(t){e(addSelectedImageId(t))},removeSelectedImageId:function(t){e(removeSelectedImageId(t))},deleteImages:function(t,r){e(deleteImages(t,r))},clearSelectedImageIds:function(){e(clearSelectedImageIds())}}},UserImagesContainer=function(e){function t(t){e.call(this,t),this.imageIsSelected=this.imageIsSelected.bind(this),this.deleteSelectedImages=this.deleteSelectedImages.bind(this),this.clearSelected=this.clearSelected.bind(this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.componentDidMount=function(){var e=this.props.params,t=e.username,r=this.props,o=r.router,n=r.route;document.title=t+"'s billeder",o.setRouteLeaveHook(n,this.clearSelected)},t.prototype.clearSelected=function(){var e=this.props,t=e.clearSelectedImageIds;return t(),!0},t.prototype.imageIsSelected=function(e){var t=this.props,r=t.selectedImageIds,o=underscore.find(r,function(t){return t==e});return!!o},t.prototype.deleteSelectedImages=function(){var e=this.props,t=e.selectedImageIds,r=e.deleteImages,o=this.props.params,n=o.username;r(n,t),this.clearSelected()},t.prototype.uploadView=function(){var e=this.props,t=e.canEdit,r=e.uploadImage,o=e.selectedImageIds,n=this.props.params,a=n.username,s=o.length>0;return t?React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lg:4},React.createElement(ImageUpload,{uploadImage:r,username:a}," ",React.createElement(reactBootstrap.Button,{bsStyle:"danger",disabled:!s,onClick:this.deleteSelectedImages},"Slet markeret billeder")))):null},t.prototype.uploadLimitView=function(){var e=this.props,t=e.canEdit;e.uploadImage,e.selectedImageIds;return t?React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lgOffset:2,lg:2},React.createElement("br",null),React.createElement(UsedSpace,null))):null},t.prototype.render=function(){var e=this.props.params,t=e.username,r=this.props,o=r.images,n=r.fullName,a=r.canEdit,s=r.addSelectedImageId,c=r.removeSelectedImageId;return React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lgOffset:2,lg:8},React.createElement(Breadcrumb,null,React.createElement(Breadcrumb.Item,{href:"/"},"Forside"),React.createElement(Breadcrumb.Item,{active:!0},t,"'s billeder")))),React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lgOffset:2,lg:8},React.createElement("h1",null,React.createElement("span",{className:"text-capitalize"},n),"'s ",React.createElement("small",null,"billede galleri")),React.createElement("hr",null),React.createElement(ImageList,{images:o,canEdit:a,addSelectedImageId:s,removeSelectedImageId:c,imageIsSelected:this.imageIsSelected,username:t}),this.uploadView())),this.uploadLimitView(),this.props.children)},t}(React.Component),UserImagesRedux=reactRedux.connect(mapStateToProps$7,mapDispatchToProps$8)(UserImagesContainer),UserImages=reactRouter.withRouter(UserImagesRedux),mapStateToProps$8=function(e){var t=e.imagesInfo.ownerId,r=e.usersInfo.currentUserId,o=t>0&&r>0&&t==r,n=function(t){return underscore.find(e.imagesInfo.images,function(e){return e.ImageID==t})},a=function(){return n(e.imagesInfo.selectedImageId)},s=function(){return a()?a().Filename:""},c=function(){return a()?a().PreviewUrl:""},i=function(){return a()?a().Extension:""},l=function(){return a()?a().OriginalUrl:""},p=function(){return a()?a().Uploaded:new Date};return{canEdit:o,hasImage:function(){return Boolean(n(e.imagesInfo.selectedImageId))},filename:s(),previewUrl:c(),extension:i(),originalUrl:l(),uploaded:p()}},mapDispatchToProps$9=function(e){return{setSelectedImageId:function(t){e(setSelectedImg(t))},deselectImage:function(){e(setSelectedImg(void 0))},setError:function(t){e(setError(t))},fetchImage:function(t){e(fetchSingleImage(t))},deleteImage:function(t,r){e(deleteImage(t,r))},resetComments:function(){e(setSkipComments(0)),e(setTakeComments(10)),e(setFocusedComment(-1)),e(receivedComments([]))}}},ModalImage=function(e){function t(t){e.call(this,t),this.deleteImageHandler=this.deleteImageHandler.bind(this),this.close=this.close.bind(this),this.seeAllCommentsView=this.seeAllCommentsView.bind(this),this.reload=this.reload.bind(this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.close=function(){var e=this.props,t=e.deselectImage,r=e.resetComments,o=this.props.params,n=o.username,a=this.props.router,s=a.push;t();var c="/"+n+"/gallery";r(),s(c)},t.prototype.deleteImageHandler=function(){var e=this.props,t=e.deleteImage,r=e.setSelectedImageId,o=this.props.params,n=o.id,a=o.username;t(n,a),r(-1)},t.prototype.deleteImageView=function(){var e=this.props,t=e.canEdit;return t?React.createElement(reactBootstrap.Button,{bsStyle:"danger",onClick:this.deleteImageHandler},"Slet billede"):null},t.prototype.reload=function(){var e=this.props.params,t=e.id,r=e.username,o=this.props.router,n=o.push,a="/"+r+"/gallery/image/"+t+"/comments";n(a)},t.prototype.seeAllCommentsView=function(){var e=!Boolean(this.props.children);return e?React.createElement("p",{className:"text-center"},React.createElement(reactBootstrap.Button,{onClick:this.reload},React.createElement(reactBootstrap.Glyphicon,{glyph:"refresh"})," Se alle kommentarer?")):null},t.prototype.render=function(){var e=this.props,t=e.filename,r=e.previewUrl,o=e.extension,n=e.originalUrl,a=e.uploaded,s=e.hasImage,c=s(),i=t+"."+o,l=moment(a),p="Uploaded d. "+l.format("D MMM YYYY ")+"kl. "+l.format("H:mm");return React.createElement(reactBootstrap.Modal,{show:c,onHide:this.close,bsSize:"large",animation:!0},React.createElement(reactBootstrap.Modal.Header,{closeButton:!0},React.createElement(reactBootstrap.Modal.Title,null,i,React.createElement("span",null,React.createElement("small",null," - ",p)))),React.createElement(reactBootstrap.Modal.Body,null,React.createElement("a",{href:n,target:"_blank",rel:"noopener"},React.createElement(reactBootstrap.Image,{src:r,responsive:!0,className:"center-block"}))),React.createElement(reactBootstrap.Modal.Footer,null,this.seeAllCommentsView(),this.props.children,React.createElement("hr",null),React.createElement(reactBootstrap.ButtonToolbar,{style:{float:"right"}},this.deleteImageView(),React.createElement(reactBootstrap.Button,{onClick:this.close},"Luk"))))},t}(React.Component),SelectedImageRedux=reactRedux.connect(mapStateToProps$8,mapDispatchToProps$9)(ModalImage),SelectedImage=reactRouter.withRouter(SelectedImageRedux),mapStateToProps$9=function(e){return{canEdit:function(t){return e.usersInfo.currentUserId==t},imageId:e.imagesInfo.selectedImageId,skip:e.commentsInfo.skip,take:e.commentsInfo.take,page:e.commentsInfo.page,totalPages:e.commentsInfo.totalPages,comments:e.commentsInfo.comments,getName:function(t){var r=e.usersInfo.users[t],o=r.FirstName,n=r.LastName;return o+" "+n},owner:e.usersInfo.users[e.imagesInfo.ownerId]}},mapDispatchToProps$10=function(e){return{postHandle:function(t,r,o){var n=globals.urls.imagecomments;e(postComment(n,t,r,null,o))},fetchComments:function(t,r,o){var n=getImageCommentsPageUrl(t,r,o);e(fetchComments(n,r,o))},editHandle:function(t,r,o,n){var a=globals.urls.imagecomments;e(editComment(a,t,o,n))},deleteHandle:function(t,r){var o=getImageCommentsDeleteUrl(t);e(deleteComment(o,r))},replyHandle:function(t,r,o,n){var a=globals.urls.imagecomments;e(postComment(a,t,r,o,n))},incrementCount:function(t){return e(incrementCommentCount(t))},decrementCount:function(t){return e(decrementCommentCount(t))},loadComments:function(t,r,o){var n=getImageCommentsPageUrl(t,r,o);e(fetchComments(n,r,o))}}},CommentsContainer=function(e){function t(t){e.call(this,t),this.pageHandle=this.pageHandle.bind(this),this.deleteComment=this.deleteComment.bind(this),this.editComment=this.editComment.bind(this),this.replyComment=this.replyComment.bind(this),this.postComment=this.postComment.bind(this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.componentWillReceiveProps=function(e){var t=this.props,r=t.fetchComments,o=t.imageId,n=(t.skip,t.take),a=e.location.query,s=a.page;if(Number(s)){var c=s-1,i=c*n;r(o,i,n)}},t.prototype.pageHandle=function(e){var t=this.props,r=t.owner,o=t.imageId,n=t.page,a=this.props.router,s=a.push,c=r.Username;if(n!=e){var i="/"+c+"/gallery/image/"+o+"/comments?page="+e;s(i)}},t.prototype.deleteComment=function(e,t){var r=this.props,o=r.deleteHandle,n=r.loadComments,a=r.decrementCount,s=r.skip,c=r.take,i=function(){a(t),n(t,s,c)};o(e,i)},t.prototype.editComment=function(e,t,r){var o=this.props,n=o.loadComments,a=o.skip,s=o.take,c=o.editHandle,i=function(){return n(t,a,s)};c(e,t,r,i)},t.prototype.replyComment=function(e,t,r){var o=this.props,n=o.loadComments,a=o.incrementCount,s=o.skip,c=o.take,i=o.replyHandle,l=function(){a(e),n(e,s,c)};i(e,t,r,l)},t.prototype.postComment=function(e){var t=this.props,r=t.imageId,o=t.loadComments,n=t.incrementCount,a=t.skip,s=t.take,c=t.postHandle,i=function(){n(r),o(r,a,s)};c(r,e,i)},t.prototype.render=function(){var e=this.props,t=e.canEdit,r=e.comments,o=e.getName,n=e.imageId,a=e.page,s=e.totalPages,c=this.props,i=c.skip,l=c.take,p={skip:i,take:l};return p=Object.assign({},p,{deleteComment:this.deleteComment,editComment:this.editComment,replyComment:this.replyComment}),React.createElement("div",{className:"text-left"},React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lgOffset:1,lg:11},React.createElement(CommentList,{contextId:n,comments:r,getName:o,canEdit:t,props:!0}))),React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lgOffset:1,lg:10},React.createElement(Pagination$1,{totalPages:s,page:a,pageHandle:this.pageHandle}))),React.createElement("hr",null),React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lgOffset:1,lg:10},React.createElement(CommentForm,{postHandle:this.postComment}))))},t}(React.Component),CommentsRedux=reactRedux.connect(mapStateToProps$9,mapDispatchToProps$10)(CommentsContainer),ImageComments=reactRouter.withRouter(CommentsRedux),mapStateToProps$10=function(e){var t=e.commentsInfo,r=t.comments,o=t.focusedComment,n=e.usersInfo,a=n.users,s=e.imagesInfo,c=s.ownerId,i=s.selectedImageId;return{getName:function(e){var t=a[e];return t.FirstName+" "+t.LastName},focusedId:o,focused:r[0],imageId:i,imageOwner:a[c].Username,canEdit:function(t){return e.usersInfo.currentUserId==t},skip:e.commentsInfo.skip,take:e.commentsInfo.take}},mapDispatchToProps$11=function(e){return{editHandle:function(t,r,o,n){var a=globals.urls.imagecomments;e(editComment(a,t,o,n))},deleteHandle:function(t,r){var o=getImageCommentsDeleteUrl(t);e(deleteComment(o,r))},replyHandle:function(t,r,o,n){var a=globals.urls.imagecomments;e(postComment(a,t,r,o,n))},focusComment:function(t){return e(fetchAndFocusSingleComment(t))}}},SingleCommentRedux=function(e){function t(t){e.call(this,t),this.allComments=this.allComments.bind(this),this.deleteComment=this.deleteComment.bind(this),this.editComment=this.editComment.bind(this),this.replyComment=this.replyComment.bind(this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.allComments=function(){var e=this.props,t=e.imageId,r=e.imageOwner,o=this.props.router,n=o.push,a="/"+r+"/gallery/image/"+t+"/comments";n(a)},t.prototype.deleteComment=function(e,t){var r=this.props,o=r.deleteHandle;o(e,this.allComments)},t.prototype.editComment=function(e,t,r){var o=this.props,n=o.editHandle,a=o.focusComment,s=function(){return a(e)};n(e,t,r,s)},t.prototype.replyComment=function(e,t,r){var o=this.props,n=o.replyHandle;n(e,t,r,this.allComments)},t.prototype.render=function(){var e=this.props,t=e.focusedId;if(t<0)return null;var r=this.props.focused,o=r.Text,n=r.AuthorID,a=r.CommentID,s=r.PostedOn,c=r.Edited,i=this.props,l=i.canEdit,p=i.imageId,m=this.props,u=m.skip,d=m.take,h={skip:u,take:d};h=Object.assign({},h,{deleteComment:this.deleteComment,editComment:this.editComment,replyComment:this.replyComment});var f=this.props.getName(n);return React.createElement("div",{className:"text-left"},React.createElement(reactBootstrap.Well,null,React.createElement(Comment,{contextId:p,name:f,text:o,commentId:a,replies:[],canEdit:l,authorId:n,postedOn:s,edited:c,props:!0})),React.createElement("div",null,React.createElement("p",{className:"text-center"},React.createElement(reactBootstrap.Button,{onClick:this.allComments},React.createElement(reactBootstrap.Glyphicon,{glyph:"refresh"})," Se alle kommentarer?"))))},t}(React.Component),SingleCommentConnect=reactRedux.connect(mapStateToProps$10,mapDispatchToProps$11)(SingleCommentRedux),SingleImageComment=reactRouter.withRouter(SingleCommentConnect),About=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.componentDidMount=function(){document.title="Om"},t.prototype.render=function(){return React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lgOffset:2,lg:8},React.createElement(Breadcrumb,null,React.createElement(Breadcrumb.Item,{href:"/"},"Forside"),React.createElement(Breadcrumb.Item,{active:!0},"Om")))),React.createElement(reactBootstrap.Col,{lgOffset:2,lg:8},React.createElement("p",null,"Dette er en single page application! ",React.createElement("br",null),"Teknologier brugt:"),React.createElement("ul",null,React.createElement("li",null,"React"),React.createElement("li",null,"Redux"),React.createElement("li",null,"React-Bootstrap"),React.createElement("li",null,"ReactRouter"),React.createElement("li",null,"Asp.net Core RC 2"),React.createElement("li",null,"Asp.net Web API 2"))))},t}(React.Component),users=function(e,t){switch(void 0===e&&(e={}),t.type){case ADD_USER:var r=put(e,t.user.ID,t.user);return r;case RECIEVED_USERS:return t.users;default:return e}},currentUserId=function(e,t){switch(void 0===e&&(e=-1),t.type){case SET_CURRENT_USER_ID:return t.id||-1;default:return e}},usersInfo=redux.combineReducers({currentUserId:currentUserId,users:users}),ownerId=function(e,t){switch(void 0===e&&(e=-1),t.type){case SET_IMAGES_OWNER:return t.id||-1;default:return e}},images=function(e,t){switch(void 0===e&&(e={}),t.type){case ADD_IMAGE:var r=put(e,t.key,t.val);return r;case RECIEVED_USER_IMAGES:return t.images;case REMOVE_IMAGE:var o=underscore.omit(e,t.key);return o;case INCR_IMG_COMMENT_COUNT:return underscore.values(e).map(function(e){return e.ImageID==t.key&&e.CommentCount++,e});case DECR_IMG_COMMENT_COUNT:return underscore.values(e).map(function(e){return e.ImageID==t.key&&e.CommentCount--,e});default:return e}},selectedImageId=function(e,t){switch(void 0===e&&(e=-1),t.type){case SET_SELECTED_IMG:return t.id||-1;default:return e}},selectedImageIds=function(e,t){switch(void 0===e&&(e=[]),t.type){case ADD_SELECTED_IMAGE_ID:return union(e,[t.id],function(e,t){return e==t});case REMOVE_SELECTED_IMAGE_ID:return underscore.filter(e,function(e){return e!=t.id});case CLEAR_SELECTED_IMAGE_IDS:return[];default:return e}},imagesInfo=redux.combineReducers({ownerId:ownerId,images:images,selectedImageId:selectedImageId,selectedImageIds:selectedImageIds}),comments=function(e,t){switch(void 0===e&&(e=[]),t.type){case RECIEVED_COMMENTS:return t.comments||[];case ADD_COMMENT:return e.concat([t.comment]);default:return e}},skip=function(e,t){switch(void 0===e&&(e=0),t.type){case SET_SKIP_COMMENTS:return t.skip||0;default:return e}},take=function(e,t){switch(void 0===e&&(e=10),t.type){case SET_TAKE_COMMENTS:return t.take||10;default:return e}},page=function(e,t){switch(void 0===e&&(e=1),t.type){case SET_CURRENT_PAGE:return t.page||1;default:return e}},totalPages=function(e,t){switch(void 0===e&&(e=0),t.type){case SET_TOTAL_PAGES:return t.totalPages||0;default:return e}},focusedComment=function(e,t){switch(void 0===e&&(e=-1),t.type){case SET_FOCUSED_COMMENT:return t.id||-1;default:return e}},commentsInfo=redux.combineReducers({comments:comments,skip:skip,take:take,page:page,totalPages:totalPages,focusedComment:focusedComment}),title=function(e,t){switch(void 0===e&&(e=""),t.type){case SET_ERROR_TITLE:return t.title||"";default:return e}},message$1=function(e,t){switch(void 0===e&&(e=""),t.type){case SET_ERROR_MESSAGE:return t.message||"";default:return e}},errorInfo=redux.combineReducers({title:title,message:message$1}),hasError=function(e,t){switch(void 0===e&&(e=!1),t.type){case SET_HAS_ERROR:return t.hasError;default:return e}},message=function(e,t){switch(void 0===e&&(e=""),t.type){default:return e}},done=function(e,t){switch(void 0===e&&(e=!0),t.type){default:return e}},usedSpacekB=function(e,t){switch(void 0===e&&(e=0),t.type){case SET_USED_SPACE_KB:return t.usedSpace;default:return e}},totalSpacekB=function(e,t){switch(void 0===e&&(e=-1),t.type){case SET_TOTAL_SPACE_KB:return t.totalSpace;default:return e}},spaceInfo=redux.combineReducers({usedSpacekB:usedSpacekB,totalSpacekB:totalSpacekB}),statusInfo=redux.combineReducers({hasError:hasError,errorInfo:errorInfo,spaceInfo:spaceInfo,message:message,done:done}),skip$1=function(e,t){switch(void 0===e&&(e=0),t.type){case SET_SKIP_WHATS_NEW:return t.skip||0;default:return e}},take$1=function(e,t){switch(void 0===e&&(e=10),t.type){case SET_TAKE_WHATS_NEW:return t.take||10;default:return e}},page$1=function(e,t){switch(void 0===e&&(e=1),t.type){case SET_PAGE_WHATS_NEW:return t.page||1;default:return e}},totalPages$1=function(e,t){switch(void 0===e&&(e=0),t.type){case SET_TOTAL_PAGES_WHATS_NEW:return t.totalPages||0;default:return e}},items=function(e,t){switch(void 0===e&&(e=[]),t.type){case SET_LATEST:return t.latest||[];default:return e}},whatsNewInfo=redux.combineReducers({skip:skip$1,take:take$1,page:page$1,totalPages:totalPages$1,items:items}),skipThreads=function(e,t){switch(void 0===e&&(e=0),t.type){case SET_SKIP_THREADS:return t.skip;default:return e}},takeThreads=function(e,t){switch(void 0===e&&(e=10),t.type){case SET_TAKE_THREADS:return t.take;default:return e}},pageThreads=function(e,t){switch(void 0===e&&(e=1),t.type){case SET_PAGE_THREADS:return t.page;default:return e}},totalPagesThread=function(e,t){switch(void 0===e&&(e=1),t.type){case SET_TOTAL_PAGES_THREADS:return t.totalPages;default:return e}},selectedThread=function(e,t){switch(void 0===e&&(e=-1),t.type){case SET_SELECTEDTHREAD_ID:return t.id;default:return e}},titles=function(e,t){switch(void 0===e&&(e=[]),t.type){case ADD_THREAD_TITLE:return union([t.title],e,function(e,t){return e.ID==t.ID});case SET_THREAD_TITLES:return t.titles;case UPDATE_THREAD_TITLE:var r=underscore.filter(e,function(e){return e.ID!=t.id});return r.concat([t.title]);default:return e}},postContent=function(e,t){switch(void 0===e&&(e=""),t.type){case SET_POST_CONTENT:return t.content;default:return e}},titlesInfo=redux.combineReducers({titles:titles,skip:skipThreads,take:takeThreads,page:pageThreads,totalPages:totalPagesThread,selectedThread:selectedThread}),forumInfo=redux.combineReducers({titlesInfo:titlesInfo,postContent:postContent}),rootReducer=redux.combineReducers({usersInfo:usersInfo,imagesInfo:imagesInfo,commentsInfo:commentsInfo,statusInfo:statusInfo,whatsNewInfo:whatsNewInfo,forumInfo:forumInfo}),store=redux.createStore(rootReducer,redux.applyMiddleware(thunk)),init=function(){store.dispatch(fetchCurrentUser(globals.currentUsername)),store.dispatch(fetchUsers()),moment.locale("da"),connectToLatestWebSocketService()},connectToLatestWebSocketService=function(){"WebSocket"in window||"MozWebSocket"in window;setInterval(function(){var e=store.getState().whatsNewInfo,t=e.skip,r=e.take,o=store.getState().forumInfo.titlesInfo.skip,n=store.getState().forumInfo.titlesInfo.take;store.dispatch(fetchUsers()),store.dispatch(fetchLatestNews(t,r)),store.dispatch(fetchThreads(o,n)),store.dispatch(fetchSpaceInfo(globals.urls.diagnostics+"/getspaceinfo"))},1e4)},selectImage=function(e){var t=Number(e.params.id);store.dispatch(setSelectedImg(t))},fetchImages=function(e){var t=e.params.username;store.dispatch(setImageOwner(t)),store.dispatch(fetchUserImages(t)),store.dispatch(setSkipComments(void 0)),store.dispatch(setTakeComments(void 0))},loadComments=function(e){var t=e.params,r=(t.username,t.id),o=Number(e.location.query.page),n=store.getState().commentsInfo,a=n.skip,s=n.take,c=getImageCommentsPageUrl(r,a,s);if(o){var i=o-1,l=i*s;store.dispatch(fetchComments(c,l,s))}else store.dispatch(fetchComments(c,a,s))},fetchComment=function(e){var t=Number(e.location.query.id);store.dispatch(fetchAndFocusSingleComment(t))},fetchWhatsNew=function(e){var t=function(e,t){return store.dispatch(fetchLatestNews(e,t))},r=store.getState().whatsNewInfo,o=r.skip,n=r.take;t(o,n)},fetchForum=function(e){var t=store.getState().forumInfo.titlesInfo,r=t.skip,o=t.take;store.dispatch(fetchThreads(r,o))},fetchSinglePost=function(e){var t=e.params,r=t.id;store.dispatch(fetchPost(Number(r)))},fetchPostComments=function(e){var t=e.params,r=t.id,o=store.getState().commentsInfo,n=o.skip,a=o.take,s=getForumCommentsPageUrl(r,n,a);store.dispatch(fetchComments(s,n,a))};init(),ReactDOM.render(React.createElement(reactRedux.Provider,{store:store},React.createElement(reactRouter.Router,{history:reactRouter.browserHistory},React.createElement(reactRouter.Route,{path:"/",component:Main},React.createElement(reactRouter.IndexRoute,{component:Home,onEnter:fetchWhatsNew}),React.createElement(reactRouter.Route,{path:"forum",component:Forum},React.createElement(reactRouter.IndexRoute,{component:ForumList,onEnter:fetchForum}),React.createElement(reactRouter.Route,{path:"post/:id",component:ForumPost,onEnter:fetchSinglePost},React.createElement(reactRouter.Route,{path:"comments",component:ForumComments,onEnter:fetchPostComments}))),React.createElement(reactRouter.Route,{path:"users",component:Users}),React.createElement(reactRouter.Route,{path:":username/gallery",component:UserImages,onEnter:fetchImages},React.createElement(reactRouter.Route,{path:"image/:id",component:SelectedImage,onEnter:selectImage},React.createElement(reactRouter.Route,{path:"comments",component:ImageComments,onEnter:loadComments}),React.createElement(reactRouter.Route,{path:"comment",component:SingleImageComment,onEnter:fetchComment}))),React.createElement(reactRouter.Route,{path:"about",component:About})))),document.getElementById("content"));