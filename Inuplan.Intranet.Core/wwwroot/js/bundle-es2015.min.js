"use strict";function _interopDefault(n){return n&&typeof n=="object"&&"default"in n?n["default"]:n}function union(n,t,i){for(var u,r=n.concat(t),f=0;f<r.length;f++)for(u=f+1;u<r.length;u++)i(r[f],r[u])&&(r.splice(u,1),u--);return r}function setCurrentUserId(n){return{type:SET_CURRENT_USER_ID,id:n}}function addUser(n){return{type:ADD_USER,user:n}}function recievedUsers(n){return{type:RECIEVED_USERS,users:n}}function fetchCurrentUser(n){return function(t){var i=getUrl(n),r=responseHandler.bind(this,t);return fetch(i,options).then(r).then(function(n){t(setCurrentUserId(n.ID));t(addUser(n))},onReject)}}function fetchUsers(){return function(n){var t=responseHandler.bind(this,n);return fetch(globals.urls.users,options).then(t).then(function(t){return n(recievedUsers(t))},onReject)}}function addLatest(n){return{type:ADD_LATEST,latest:n}}function setSKip(n){return{type:SET_SKIP_WHATS_NEW,skip:n}}function setTake(n){return{type:SET_TAKE_WHATS_NEW,take:n}}function setPage(n){return{type:SET_PAGE_WHATS_NEW,page:n}}function setTotalPages(n){return{type:SET_TOTAL_PAGES_WHATS_NEW,totalPages:n}}function fetchLatestNews(n,t){return function(i){var r=globals.urls.whatsnew+"?skip="+n+"&take="+t,u=responseHandler.bind(this,i);return fetch(r,options).then(u).then(function(r){var u=r.CurrentItems,f;u.forEach(function(n){var t=n.Item.Author;t&&i(addUser(t))});i(setSKip(n));i(setTake(t));i(setPage(r.CurrentPage));i(setTotalPages(r.TotalPages));f=u.filter(function(n){return Boolean(n.Item.Author)}).map(normalizeLatest);i(addLatest(f))},onReject)}}function setImagesOwner(n){return{type:SET_IMAGES_OWNER,id:n}}function recievedUserImages(n){return{type:RECIEVED_USER_IMAGES,images:n}}function addImage(n){return{type:ADD_IMAGE,image:n}}function removeImage(n){return{type:REMOVE_IMAGE,id:n}}function addSelectedImageId(n){return{type:ADD_SELECTED_IMAGE_ID,id:n}}function removeSelectedImageId(n){return{type:REMOVE_SELECTED_IMAGE_ID,id:n}}function clearSelectedImageIds(){return{type:CLEAR_SELECTED_IMAGE_IDS}}function deleteImage(n,t){return function(i){var r=globals.urls.images+"?username="+t+"&id="+n,u=Object.assign({},options,{method:"DELETE"}),f=responseHandler.bind(this,i);return fetch(r,u).then(f).then(function(){return i(removeImage(n))},onReject)}}function uploadImage(n,t){return function(i){var r=globals.urls.images+"?username="+n,u=Object.assign({},options,{method:"POST",body:t}),f=responseHandler.bind(this,i);return fetch(r,u).then(f).then(function(){return i(fetchUserImages(n))},onReject)}}function fetchUserImages(n){return function(t){var i=globals.urls.images+"?username="+n,r=responseHandler.bind(this,t),u=function(n){var i=n.map(normalizeImage).reverse();t(recievedUserImages(i))};return fetch(i,options).then(r).then(u,onReject)}}function deleteImages(n,t){return t===void 0&&(t=[]),function(i){var r=t.join(),u=globals.urls.images+"?username="+n+"&ids="+r,f=Object.assign({},options,{method:"DELETE"}),e=responseHandler.bind(this,i);return fetch(u,f).then(e).then(function(){return i(clearSelectedImageIds())},onReject).then(function(){return i(fetchUserImages(n))})}}function setImageOwner(n){return function(t,i){var u=function(){return underscore.find(i().usersInfo.users,function(t){return t.Username==n})},r=u(),f,e,o;return r?(f=r.ID,t(setImagesOwner(f)),Promise.resolve()):(e=globals.urls.users+"?username="+n,o=responseHandler.bind(this,t),fetch(e,options).then(o).then(function(n){return t(addUser(n))},onReject).then(function(){r=u();t(setImagesOwner(r.ID))}))}}function fetchSingleImage(n){return function(t){var i=globals.urls.images+"/getbyid?id="+n,r=responseHandler.bind(this,t);return fetch(i,options).then(r).then(function(n){if(n){var i=normalizeImage(n);t(addImage(i))}})}}function setCurrentPage(n){return{type:SET_CURRENT_PAGE,page:n}}function setTotalPages$1(n){return{type:SET_TOTAL_PAGES,totalPages:n}}function receivedComments(n){return{type:RECIEVED_COMMENTS,comments:n}}function fetchComments(n,t,i){return function(r){var u=globals.urls.comments+"?imageId="+n+"&skip="+t+"&take="+i,f=responseHandler.bind(this,r);return fetch(u,options).then(f).then(function(n){var u=n.CurrentItems,f,e;r(setSkipComments(t));r(setTakeComments(i));r(setCurrentPage(n.CurrentPage));r(setTotalPages$1(n.TotalPages));f=function(n){n.Deleted||r(addUser(n.Author))};visitComments(u,f);e=u.map(normalizeComment);r(receivedComments(e))},onReject)}}var React=_interopDefault(require("react")),ReactDOM=_interopDefault(require("react-dom")),reactRedux=require("react-redux"),redux=require("redux"),thunk=_interopDefault(require("redux-thunk")),underscore=require("underscore"),marked=_interopDefault(require("marked")),removeMd=_interopDefault(require("remove-markdown")),reactRouter=require("react-router"),fetch=_interopDefault(require("isomorphic-fetch")),reactBootstrap=require("react-bootstrap"),SET_SELECTED_IMG="SET_SELECTED_IMG",ADD_IMAGE="ADD_IMAGE",REMOVE_IMAGE="REMOVE_IMAGE",SET_IMAGES_OWNER="SET_IMAGES_OWNER",RECIEVED_USER_IMAGES="RECIEVED_USER_IMAGES",ADD_SELECTED_IMAGE_ID="ADD_SELECTED_IMAGE_ID",REMOVE_SELECTED_IMAGE_ID="REMOVE_SELECTED_IMAGE_ID",CLEAR_SELECTED_IMAGE_IDS="CLEAR_SELECTED_IMAGE_IDS",SET_CURRENT_USER_ID="SET_CURRENT_USER_ID",ADD_USER="ADD_USER",RECIEVED_USERS="RECIEVED_USERS",RECIEVED_COMMENTS="RECIEVED_COMMENTS",SET_CURRENT_PAGE="SET_CURRENT_PAGE",SET_TOTAL_PAGES="SET_TOTAL_PAGES",SET_SKIP_COMMENTS="SET_SKIP_COMMENTS",SET_TAKE_COMMENTS="SET_TAKE_COMMENTS",INCR_COMMENT_COUNT="INCR_COMMENT_COUNT",DECR_COMMENT_COUNT="DECR_COMMENT_COUNT",ADD_LATEST="ADD_LATEST",SET_SKIP_WHATS_NEW="SET_SKIP_WHATS_NEW",SET_TAKE_WHATS_NEW="SET_TAKE_WHATS_NEW",SET_PAGE_WHATS_NEW="SET_PAGE_WHATS_NEW",SET_TOTAL_PAGES_WHATS_NEW="SET_TOTAL_PAGES_WHATS_NEW",SET_ERROR_TITLE="SET_ERROR_TITLE",SET_ERROR_MESSAGE="SET_ERROR_MESSAGE",SET_HAS_ERROR="SET_HAS_ERROR",CLEAR_ERROR_TITLE="CLEAR_ERROR_TITLE",CLEAR_ERROR_MESSAGE="CLEAR_ERROR_MESSAGE",setErrorTitle=function(n){return{type:SET_ERROR_TITLE,title:n}},clearErrorTitle=function(){return{type:CLEAR_ERROR_TITLE}},setErrorMessage=function(n){return{type:SET_ERROR_MESSAGE,message:n}},clearErrorMessage=function(){return{type:CLEAR_ERROR_MESSAGE}},clearError=function(){return function(n){return n(clearErrorTitle()),n(clearErrorMessage()),n(setHasError(!1)),Promise.resolve()}},setHasError=function(n){return{type:SET_HAS_ERROR,hasError:n}},setError=function(n){return function(t){return t(setHasError(!0)),t(setErrorTitle(n.title)),t(setErrorMessage(n.message)),Promise.resolve()}},HttpError=function(n,t){this.title=n;this.message=t},normalizeImage=function(n){return{ImageID:n.ImageID,Filename:n.Filename,Extension:n.Extension,OriginalUrl:n.OriginalUrl,PreviewUrl:n.PreviewUrl,ThumbnailUrl:n.ThumbnailUrl,CommentCount:n.CommentCount,Uploaded:new Date(n.Uploaded)}},normalizeComment=function(n){var t=n.Replies?n.Replies:[],i=t.map(normalizeComment),r=n.Deleted?-1:n.Author.ID;return{CommentID:n.ID,AuthorID:r,Deleted:n.Deleted,PostedOn:n.PostedOn,Text:n.Text,Replies:i}},normalizeLatest=function(n){var r=null,t,i;return n.Type==1?(t=n.Item,r={Extension:t.Extension,Filename:t.Filename,ImageID:t.ImageID,OriginalUrl:t.OriginalUrl,PreviewUrl:t.PreviewUrl,ThumbnailUrl:t.ThumbnailUrl,Uploaded:t.Uploaded}):n.Type==2&&(i=n.Item,r={ID:i.ID,Text:i.Text,ImageID:i.ImageID,ImageUploadedBy:i.ImageUploadedBy}),{ID:n.ID,Type:n.Type,Item:r,On:n.On,AuthorID:n.Item.Author.ID}},visitComments=function(n,t){for(var r=function(n){return n.Replies?n.Replies:[]},i=0;i<n.length;i++)depthFirstSearch(n[i],r,t)},depthFirstSearch=function(n,t,i){var u,r;for(i(n),u=t(n),r=0;r<u.length;r++)depthFirstSearch(u[r],t,i)},userEquality=function(n,t){return!t||!n?!1:n.ID==t.ID},formatText=function(n){if(n){var t=marked(n,{sanitize:!0});return{__html:t}}},getWords=function(n,t){if(!n)return"";var i=removeMd(n);return i.split(/\s+/).slice(0,t).join(" ")},timeText=function(n){var i=moment(n).fromNow(),r=moment().diff(n,"hours",!0),t;return r>=12.5?(t=moment(n),"d. "+t.format("D MMM YYYY ")+"kl. "+t.format("H:mm")):"for "+i},responseHandler=function(n,t){if(t.ok)return t.json();switch(t.status){case 400:n(setError(new HttpError("400 Bad Request","The request was not well-formed")));break;case 404:n(setError(new HttpError("404 Not Found","Could not find resource")));break;case 408:n(setError(new HttpError("408 Request Timeout","The server did not respond in time")));case 500:n(setError(new HttpError("500 Server Error","Something went wrong with the API-server")));break;default:n(setError(new HttpError("Oops","Something went wrong!")))}return Promise.reject()},onReject=function(){},users=function(n,t){n===void 0&&(n=[]);switch(t.type){case ADD_USER:return union(n,[t.user],userEquality);case RECIEVED_USERS:return t.users;default:return n}},currentUserId=function(n,t){n===void 0&&(n=-1);switch(t.type){case SET_CURRENT_USER_ID:return t.id||-1;default:return n}},usersInfo=redux.combineReducers({currentUserId:currentUserId,users:users}),ownerId=function(n,t){n===void 0&&(n=-1);switch(t.type){case SET_IMAGES_OWNER:return t.id||-1;default:return n}},images=function(n,t){n===void 0&&(n=[]);switch(t.type){case ADD_IMAGE:return union(n,[t.image],function(n,t){return n.ImageID==t.ImageID});case RECIEVED_USER_IMAGES:return t.images;case REMOVE_IMAGE:return n.filter(function(n){return n.ImageID!=t.id});case INCR_COMMENT_COUNT:return n.map(function(n){return n.ImageID==t.imageId&&n.CommentCount++,n});case DECR_COMMENT_COUNT:return n.map(function(n){return n.ImageID==t.imageId&&n.CommentCount--,n});default:return n}},selectedImageId=function(n,t){n===void 0&&(n=-1);switch(t.type){case SET_SELECTED_IMG:return t.id||-1;default:return n}},selectedImageIds=function(n,t){n===void 0&&(n=[]);switch(t.type){case ADD_SELECTED_IMAGE_ID:return union(n,[t.id],function(n,t){return n==t});case REMOVE_SELECTED_IMAGE_ID:return underscore.filter(n,function(n){return n!=t.id});case CLEAR_SELECTED_IMAGE_IDS:return[];default:return n}},imagesInfo=redux.combineReducers({ownerId:ownerId,images:images,selectedImageId:selectedImageId,selectedImageIds:selectedImageIds}),comments=function(n,t){n===void 0&&(n=[]);switch(t.type){case RECIEVED_COMMENTS:return t.comments||[];default:return n}},skip=function(n,t){n===void 0&&(n=0);switch(t.type){case SET_SKIP_COMMENTS:return t.skip||0;default:return n}},take=function(n,t){n===void 0&&(n=10);switch(t.type){case SET_TAKE_COMMENTS:return t.take||10;default:return n}},page=function(n,t){n===void 0&&(n=1);switch(t.type){case SET_CURRENT_PAGE:return t.page||1;default:return n}},totalPages=function(n,t){n===void 0&&(n=1);switch(t.type){case SET_TOTAL_PAGES:return t.totalPages||1;default:return n}},commentsInfo=redux.combineReducers({comments:comments,skip:skip,take:take,page:page,totalPages:totalPages}),title=function(n,t){n===void 0&&(n="");switch(t.type){case SET_ERROR_TITLE:return t.title||"";default:return n}},message$1=function(n,t){n===void 0&&(n="");switch(t.type){case SET_ERROR_MESSAGE:return t.message||"";default:return n}},errorInfo=redux.combineReducers({title:title,message:message$1}),hasError=function(n,t){n===void 0&&(n=!1);switch(t.type){case SET_HAS_ERROR:return t.hasError;default:return n}},message=function(n,t){n===void 0&&(n="");switch(t.type){default:return n}},done=function(n,t){n===void 0&&(n=!0);switch(t.type){default:return n}},statusInfo=redux.combineReducers({hasError:hasError,errorInfo:errorInfo,message:message,done:done}),skip$1=function(n,t){n===void 0&&(n=0);switch(t.type){case SET_SKIP_WHATS_NEW:return t.skip||0;default:return n}},take$1=function(n,t){n===void 0&&(n=10);switch(t.type){case SET_TAKE_WHATS_NEW:return t.take||10;default:return n}},page$1=function(n,t){n===void 0&&(n=1);switch(t.type){case SET_PAGE_WHATS_NEW:return t.page||1;default:return n}},totalPages$1=function(n,t){n===void 0&&(n=0);switch(t.type){case SET_TOTAL_PAGES_WHATS_NEW:return t.totalPages||0;default:return n}},items=function(n,t){n===void 0&&(n=[]);switch(t.type){case ADD_LATEST:return t.latest||[];default:return n}},whatsNewInfo=redux.combineReducers({skip:skip$1,take:take$1,page:page$1,totalPages:totalPages$1,items:items}),rootReducer=redux.combineReducers({usersInfo:usersInfo,imagesInfo:imagesInfo,commentsInfo:commentsInfo,statusInfo:statusInfo,whatsNewInfo:whatsNewInfo}),store=redux.createStore(rootReducer,redux.applyMiddleware(thunk)),options={mode:"cors",credentials:"include"},getUrl=function(n){return globals.urls.users+"?username="+n},NavLink=function(n){function t(t){n.call(this,t)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.render=function(){var n=this.context.router.isActive(this.props.to,!0),t=n?"active":"";return React.createElement("li",{className:t},React.createElement(reactRouter.Link,this.props,this.props.children))},t}(React.Component),IndexNavLink,setSelectedImg,selectImage,fetchImages;NavLink.contextTypes={router:React.PropTypes.object};IndexNavLink=function(n){function t(t){n.call(this,t)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.render=function(){var n=this.context.router.isActive(this.props.to,!0),t=n?"active":"";return React.createElement("li",{className:t},React.createElement(reactRouter.IndexLink,this.props,this.props.children))},t}(React.Component);IndexNavLink.contextTypes={router:React.PropTypes.object};var Error$1=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.render=function(){var n=this.props,t=n.clearError,i=n.title,r=n.message;return React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lgOffset:2,lg:8},React.createElement(reactBootstrap.Alert,{bsStyle:"danger",onDismiss:t},React.createElement("strong",null,i),React.createElement("p",null,r))))},t}(React.Component),mapStateToProps=function(n){return{hasError:n.statusInfo.hasError,error:n.statusInfo.errorInfo}},mapDispatchToProps=function(n){return{clearError:function(){return n(clearError())}}},Shell=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.errorView=function(){var n=this.props,i=n.hasError,r=n.clearError,t=n.error,u=t.title,f=t.message;return i?React.createElement(Error$1,{title:u,message:f,clearError:r}):null},t.prototype.render=function(){return React.createElement(reactBootstrap.Grid,{fluid:!0},React.createElement(reactBootstrap.Navbar,null,React.createElement(reactBootstrap.Navbar.Header,null,React.createElement(reactBootstrap.Navbar.Brand,null,React.createElement(reactRouter.Link,{to:"/",className:"navbar-brand"},"Inuplan Intranet")),React.createElement(reactBootstrap.Navbar.Toggle,null)),React.createElement(reactBootstrap.Navbar.Collapse,null,React.createElement(reactBootstrap.Nav,null,React.createElement(IndexNavLink,{to:"/"},"Forside"),React.createElement(NavLink,{to:"/users"},"Brugere"),React.createElement(NavLink,{to:"/about"},"Om")),React.createElement(reactBootstrap.Navbar.Text,{pullRight:!0},"Hej, ",globals.currentUsername,"!"))),this.errorView(),this.props.children)},t}(React.Component),Main=reactRedux.connect(mapStateToProps,mapDispatchToProps)(Shell),About=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.componentDidMount=function(){document.title="Om"},t.prototype.render=function(){return React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lgOffset:2,lg:8},React.createElement("p",null,"Dette er en single page application! ",React.createElement("br",null),"Teknologier brugt:"),React.createElement("ul",null,React.createElement("li",null,"React"),React.createElement("li",null,"Redux"),React.createElement("li",null,"React-Bootstrap"),React.createElement("li",null,"ReactRouter"),React.createElement("li",null,"Asp.net Core RC 2"),React.createElement("li",null,"Asp.net Web API 2"))))},t}(React.Component);var WhatsNewItemImage=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.render=function(){return React.createElement("div",null,React.createElement("div",{className:"media-left"}),React.createElement("div",{className:"media-body"}))},t}(React.Component),CommentProfile=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.render=function(){return React.createElement("div",{className:"media-left"},React.createElement("img",{className:"media-object",src:"/images/person_icon.svg","data-holder-rendered":"true",style:{width:"64px",height:"64px"}}),this.props.children)},t}(React.Component),WhatsNewItemComment=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.createSummary=function(){var n=this.props,t=n.text;return formatText('"'+getWords(t,5)+'..."')},t.prototype.fullname=function(){var t=this.props,n=t.author;return n.FirstName+" "+n.LastName},t.prototype.when=function(){var n=this.props,t=n.on;return"sagde "+timeText(t)},t.prototype.render=function(){var n=this.props,t=n.imageId,i=n.uploadedBy,r=this.fullname(),u=this.createSummary(),f=i.Username+"/gallery/image/"+t;return React.createElement(reactBootstrap.Media.ListItem,null,React.createElement(CommentProfile,null),React.createElement(reactBootstrap.Media.Body,null,React.createElement("h5",{className:"media-heading"},r," ",React.createElement("small",null,this.when())),React.createElement("em",null,React.createElement("span",{dangerouslySetInnerHTML:u})),React.createElement(reactRouter.Link,{to:f},"Se kommentar")))},t}(React.Component),WhatsNewList=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.constructItems=function(){var n=this.props,t=n.items,i=n.getUser,r=function(n){return"whatsnew_"+n};return t.map(function(n){var t=i(n.AuthorID),u=r(n.ID);switch(n.Type){case 1:return React.createElement(WhatsNewItemImage,{id:n.ID,item:n.Item,on:n.On,author:t,key:u});case 2:return React.createElement(WhatsNewItemComment,{id:n.ID,text:n.Item.Text,uploadedBy:n.Item.ImageUploadedBy,imageId:n.Item.ImageID,on:n.On,author:t,key:u})}})},t.prototype.render=function(){var n=this.constructItems();return React.createElement(reactBootstrap.Media.List,null,n)},t}(React.Component),mapDispatchToProps$1=function(n){return{getLatest:function(t,i){return n(fetchLatestNews(t,i))}}},mapStateToProps$2=function(n){return{items:n.whatsNewInfo.items,getUser:function(t){return underscore.find(n.usersInfo.users,function(n){return n.ID==t})},skip:n.whatsNewInfo.skip,take:n.whatsNewInfo.take}},WhatsNewContainer=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.componentDidMount=function(){var n=this.props,t=n.getLatest,i=n.skip,r=n.take;t(i,r)},t.prototype.render=function(){var n=this.props,t=n.items,i=n.getUser;return React.createElement("div",null,React.createElement("h3",null,"Sidste nyt"),React.createElement(WhatsNewList,{items:t,getUser:i}))},t}(React.Component),WhatsNew=reactRedux.connect(mapStateToProps$2,mapDispatchToProps$1)(WhatsNewContainer),mapStateToProps$1=function(n){var t=n.usersInfo.users.filter(function(n){return n.Username.toUpperCase()==globals.currentUsername.toUpperCase()})[0],i=t?t.FirstName:"User";return{name:i}},HomeView=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.componentDidMount=function(){document.title="Forside"},t.prototype.render=function(){var n=this.props,t=n.name;return React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lgOffset:2,lg:8},React.createElement(reactBootstrap.Jumbotron,null,React.createElement("h1",null,"Velkommen ",React.createElement("small",null,t,"!")),React.createElement("p",{className:"lead"},"Til Inuplans intranet side")),React.createElement(WhatsNew,null)))},t}(React.Component),Home=reactRedux.connect(mapStateToProps$1,null)(HomeView),User=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.render=function(){var n=this.props,t=n.username,r=n.firstName,u=n.lastName,i=n.email,f="mailto:"+i,e="/"+t+"/gallery";return React.createElement(reactBootstrap.Col,{lg:3},React.createElement(UserItem,{title:"Brugernavn"},t),React.createElement(UserItem,{title:"Fornavn"},r),React.createElement(UserItem,{title:"Efternavn"},u),React.createElement(UserItem,{title:"Email"},React.createElement("a",{href:f},i)),React.createElement(UserItem,{title:"Billeder"},React.createElement(reactRouter.Link,{to:e},"Billeder")))},t}(React.Component),UserHeading=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.render=function(){return React.createElement(reactBootstrap.Col,{lg:6},React.createElement("strong",null,this.props.children))},t}(React.Component),UserBody=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.render=function(){return React.createElement(reactBootstrap.Col,{lg:6},this.props.children)},t}(React.Component),UserItem=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.render=function(){var n=this.props,t=n.title;return React.createElement(reactBootstrap.Row,null,React.createElement(UserHeading,null,t),React.createElement(UserBody,null,this.props.children))},t}(React.Component),UserList=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.userNodes=function(){var n=this.props,t=n.users;return t.map(function(n){var t="userId_"+n.ID;return React.createElement(User,{username:n.Username,userId:n.ID,firstName:n.FirstName,lastName:n.LastName,email:n.Email,profileUrl:n.ProfileImage,roles:n.Roles,key:t})})},t.prototype.render=function(){return React.createElement(reactBootstrap.Row,null,this.userNodes())},t}(React.Component),mapUsersToProps=function(n){return{users:n.usersInfo.users}},mapDispatchToProps$2=function(n){return{getUsers:function(){n(fetchUsers())}}},UsersContainer=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.componentDidMount=function(){document.title="Brugere";this.props.getUsers()},t.prototype.render=function(){var n=this.props,t=n.users;return React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lgOffset:2,lg:8},React.createElement(reactBootstrap.PageHeader,null,"Inuplan's ",React.createElement("small",null,"brugere")),React.createElement(reactBootstrap.Row,null,React.createElement(UserList,{users:t}))))},t}(React.Component),Users=reactRedux.connect(mapUsersToProps,mapDispatchToProps$2)(UsersContainer);setSelectedImg=function(n){return{type:SET_SELECTED_IMG,id:n}};var ImageUpload=function(n){function t(t){n.call(this,t);this.handleSubmit=this.handleSubmit.bind(this)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.clearInput=function(n){if(n.value){try{n.value=""}catch(u){}if(n.value){var t=document.createElement("form"),i=n.parentNode,r=n.nextSibling;t.appendChild(n);t.reset();i.insertBefore(n,r)}}},t.prototype.getFiles=function(){var n=document.getElementById("files");return n?n.files:[]},t.prototype.handleSubmit=function(n){var u=this.props,o=u.uploadImage,s=u.username,t,r,i,f,e;if(n.preventDefault(),t=this.getFiles(),t.length!=0){for(r=new FormData,i=0;i<t.length;i++)f=t[i],r.append("file",f);o(s,r);e=document.getElementById("files");this.clearInput(e)}},t.prototype.render=function(){var n=this.props,t=n.hasImages,i=n.deleteSelectedImages;return React.createElement(reactBootstrap.Row,null,React.createElement("br",null),React.createElement(reactBootstrap.Col,{lg:4},React.createElement("form",{onSubmit:this.handleSubmit,id:"form-upload",enctype:"multipart/form-data"},React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"files"},"Upload filer:"),React.createElement("input",{type:"file",className:"form-control",id:"files",name:"files",multiple:!0})),React.createElement(reactBootstrap.Button,{bsStyle:"primary",type:"submit"},"Upload")," ",React.createElement(reactBootstrap.Button,{bsStyle:"danger",disabled:!t,onClick:i},"Slet markeret billeder"))))},t}(React.Component),Image$1=function(n){function t(t){n.call(this,t);this.checkboxHandler=this.checkboxHandler.bind(this)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.checkboxHandler=function(n){var e=this.props,t=e.image,o=n.currentTarget.checked,i,r,u,f;o?(i=this.props,r=i.addSelectedImageId,r(t.ImageID)):(u=this.props,f=u.removeSelectedImageId,f(t.ImageID))},t.prototype.commentIcon=function(n){var t=n==0?"col-lg-6 text-muted":"col-lg-6 text-primary",i={className:t};return React.createElement("div",i,React.createElement("span",{className:"glyphicon glyphicon-comment","aria-hidden":"true"})," ",n)},t.prototype.checkboxView=function(){var n=this.props,t=n.canEdit,i=n.imageIsSelected,r=n.image,u=i(r.ImageID);return t?React.createElement(reactBootstrap.Col,{lg:6,className:"pull-right text-right"},React.createElement("label",null,"Slet ",React.createElement("input",{type:"checkbox",onClick:this.checkboxHandler,checked:u}))):null},t.prototype.render=function(){var t=this.props,n=t.image,i=t.username,r=n.CommentCount;return React.createElement("div",null,React.createElement(reactRouter.Link,{to:"/"+i+"/gallery/image/"+n.ImageID},React.createElement(reactBootstrap.Image,{src:n.PreviewUrl,thumbnail:!0})),React.createElement(reactBootstrap.Row,null,React.createElement(reactRouter.Link,{to:"/"+i+"/gallery/image/"+n.ImageID},this.commentIcon(r)),this.checkboxView()))},t}(React.Component),elementsPerRow=4,ImageList=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.arrangeArray=function(n){for(var u,e,o,s,f=n.length,h=Math.ceil(f/elementsPerRow),i=[],t=0,r=0;r<h;r++)t=r*elementsPerRow,u=t+elementsPerRow,e=u>f,e?(o=n.slice(t),i.push(o)):(s=n.slice(t,u),i.push(s));return i},t.prototype.imagesView=function(n){if(n.length==0)return null;var t=this.props,i=t.addSelectedImageId,r=t.removeSelectedImageId,s=t.deleteSelectedImages,u=t.canEdit,f=t.imageIsSelected,e=t.username,o=this.arrangeArray(n);return o.map(function(n,t){var o=n.map(function(n){return React.createElement(reactBootstrap.Col,{lg:3,key:n.ImageID},React.createElement(Image$1,{image:n,canEdit:u,addSelectedImageId:i,removeSelectedImageId:r,imageIsSelected:f,username:e}))}),s="rowId"+t;return React.createElement(reactBootstrap.Row,{key:s},o)})},t.prototype.render=function(){var n=this.props,t=n.images;return React.createElement(reactBootstrap.Row,null,this.imagesView(t))},t}(React.Component),mapStateToProps$3=function(n){var t=n.imagesInfo.ownerId,i=n.usersInfo.currentUserId,r=t>0&&i>0&&t==i;return{images:n.imagesInfo.images,canEdit:r,selectedImageIds:n.imagesInfo.selectedImageIds,getFullname:function(t){var i=n.usersInfo.users.filter(function(n){return n.Username.toUpperCase()==t.toUpperCase()})[0],r=i?i.FirstName+" "+i.LastName:"User";return r.toLocaleLowerCase()}}},mapDispatchToProps$3=function(n){return{uploadImage:function(t,i){n(uploadImage(t,i))},addSelectedImageId:function(t){n(addSelectedImageId(t))},removeSelectedImageId:function(t){n(removeSelectedImageId(t))},deleteImages:function(t,i){n(deleteImages(t,i))},clearSelectedImageIds:function(){n(clearSelectedImageIds())}}},UserImagesContainer=function(n){function t(t){n.call(this,t);this.imageIsSelected=this.imageIsSelected.bind(this);this.deleteSelectedImages=this.deleteSelectedImages.bind(this);this.clearSelected=this.clearSelected.bind(this)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.componentDidMount=function(){var t=this.props.params,i=t.username,n=this.props,r=n.router,u=n.route;document.title=i+"'s billeder";r.setRouteLeaveHook(u,this.clearSelected)},t.prototype.clearSelected=function(){var n=this.props,t=n.clearSelectedImageIds;return t(),!0},t.prototype.imageIsSelected=function(n){var t=this.props,i=t.selectedImageIds,r=underscore.find(i,function(t){return t==n});return r?!0:!1},t.prototype.deleteSelectedImages=function(){var n=this.props,t=n.selectedImageIds,i=n.deleteImages,r=this.props.params,u=r.username;i(u,t)},t.prototype.uploadView=function(){var n=this.props,t=n.canEdit,i=n.uploadImage,r=n.selectedImageIds,u=this.props.params,f=u.username,e=r.length>0;return t?React.createElement(ImageUpload,{uploadImage:i,username:f,deleteSelectedImages:this.deleteSelectedImages,hasImages:e}):null},t.prototype.render=function(){var i=this.props.params,t=i.username,n=this.props,r=n.images,u=n.getFullname,f=n.canEdit,e=n.addSelectedImageId,o=n.removeSelectedImageId,s=u(t);return React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lgOffset:2,lg:8},React.createElement("h1",null,React.createElement("span",{className:"text-capitalize"},s,"'s")," ",React.createElement("small",null,"billede galleri")),React.createElement("hr",null),React.createElement(ImageList,{images:r,canEdit:f,addSelectedImageId:e,removeSelectedImageId:o,imageIsSelected:this.imageIsSelected,username:t}),this.uploadView()),this.props.children)},t}(React.Component),UserImagesRedux=reactRedux.connect(mapStateToProps$3,mapDispatchToProps$3)(UserImagesContainer),UserImages=reactRouter.withRouter(UserImagesRedux),setSkipComments=function(n){return{type:SET_SKIP_COMMENTS,skip:n}},setTakeComments=function(n){return{type:SET_TAKE_COMMENTS,take:n}};var postComment=function(n,t,i){return function(r,u){var f=u().commentsInfo,h=f.skip,c=f.take,l=globals.urls.comments,e=new Headers,o,s;return e.append("Content-Type","application/json"),o=JSON.stringify({Text:t,ImageID:n,ParentID:i}),s=Object.assign({},options,{method:"POST",body:o,headers:e}),fetch(l,s).then(function(){r(incrementCommentCount(n));r(fetchComments(n,h,c))},onReject)}},editComment=function(n,t,i){return function(r,u){var f=u().commentsInfo,s=f.skip,h=f.take,c=globals.urls.comments+"?imageId="+t,e=new Headers,o;return e.append("Content-Type","application/json"),o=Object.assign({},options,{method:"PUT",body:JSON.stringify({ID:n,Text:i}),headers:e}),fetch(c,o).then(function(){r(fetchComments(t,s,h))},onReject)}},deleteComment=function(n,t){return function(i,r){var u=r().commentsInfo,f=u.skip,e=u.take,o=globals.urls.comments+"?commentId="+n,s=Object.assign({},options,{method:"DELETE"});return fetch(o,s).then(function(){i(fetchComments(t,f,e));i(decrementCommentCount(t))},onReject)}},incrementCommentCount=function(n){return{type:INCR_COMMENT_COUNT,imageId:n}},decrementCommentCount=function(n){return{type:DECR_COMMENT_COUNT,imageId:n}},CommentDeleted=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.render=function(){var n=this.props,t=n.replies,i=n.handlers,r=n.constructComments,u=r(t,i);return React.createElement("div",{className:"media pull-left text-left"},React.createElement("div",{className:"media-left",style:{minWidth:"74px"}}),React.createElement("div",{className:"media-body"},React.createElement("small",null,"slettet"),u))},t}(React.Component),ids=function(n){return{replyId:n+"_reply",editId:n+"_edit",deleteId:n+"_delete",editCollapse:n+"_editCollapse",replyCollapse:n+"_replyCollapse"}},CommentControls=function(n){function t(t){n.call(this,t);this.state={text:t.text,reply:""};this.edit=this.edit.bind(this);this.reply=this.reply.bind(this);this.handleTextChange=this.handleTextChange.bind(this);this.handleReplyChange=this.handleReplyChange.bind(this)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.edit=function(){var n=this.props,i=n.editHandle,t=n.commentId,r=this.state,u=r.text,f=ids(t),e=f.editCollapse;i(t,u);$("#"+e).collapse("hide")},t.prototype.reply=function(){var n=this.props,i=n.replyHandle,t=n.commentId,r=this.state,u=r.reply,f=ids(t),e=f.replyCollapse;i(t,u);$("#"+e).collapse("hide");this.setState({reply:""})},t.prototype.showTooltip=function(n){var t=this.props,i=t.commentId,r="#"+i+"_"+n;$(r).tooltip("show")},t.prototype.handleTextChange=function(n){this.setState({text:n.target.value})},t.prototype.handleReplyChange=function(n){this.setState({reply:n.target.value})},t.prototype.render=function(){var s=this,t=this.props,h=t.text,u=t.commentId,c=t.canEdit,l=t.deleteHandle,n=ids(u),f=n.editCollapse,r=n.replyCollapse,e=n.replyId,a=n.editId,v=n.deleteId,o="#"+f,i="#"+r;return c?React.createElement("div",{className:"row"},React.createElement("div",{className:"row",style:{paddingBottom:"5px",paddingLeft:"15px"}},React.createElement("div",{className:"col-lg-4"},React.createElement("a",{onClick:l.bind(null,u),style:{textDecoration:"none",cursor:"pointer"}},React.createElement("span",{onMouseEnter:this.showTooltip.bind(this,"delete"),id:v,"data-toggle":"tooltip",title:"Slet",className:"label label-danger"},React.createElement("span",{className:"glyphicon glyphicon-trash"}))," "),React.createElement("a",{"data-toggle":"collapse","data-target":o,style:{textDecoration:"none",cursor:"pointer"}},React.createElement("span",{onMouseEnter:this.showTooltip.bind(this,"edit"),id:a,"data-toggle":"tooltip",title:"Ændre",className:"label label-success"},React.createElement("span",{className:"glyphicon glyphicon-pencil"}))," "),React.createElement("a",{"data-toggle":"collapse","data-target":i,style:{textDecoration:"none",cursor:"pointer"}},React.createElement("span",{onMouseEnter:this.showTooltip.bind(this,"reply"),id:e,"data-toggle":"tooltip",title:"Svar",className:"label label-primary"},React.createElement("span",{className:"glyphicon glyphicon-envelope"}))))),React.createElement("div",{className:"row",style:{paddingBottom:"5px"}},React.createElement("div",{className:"col-lg-offset-1 col-lg-10 collapse",id:f},React.createElement("textarea",{className:"form-control",value:this.state.text,onChange:this.handleTextChange,rows:"4"}),React.createElement("br",null),React.createElement("button",{type:"button","data-toggle":"collapse",onClick:function(){return s.setState({text:h})},"data-target":o,className:"btn btn-default"},"Luk"),React.createElement("button",{type:"button",className:"btn btn-info",onClick:this.edit},"Gem ændringer"))),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-lg-offset-1 col-lg-10 collapse",id:r},React.createElement("textarea",{className:"form-control",value:this.state.reply,onChange:this.handleReplyChange,rows:"4"}),React.createElement("br",null),React.createElement("button",{type:"button","data-toggle":"collapse","data-target":i,className:"btn btn-default"},"Luk"),React.createElement("button",{type:"button",className:"btn btn-info",onClick:this.reply},"Svar")))):React.createElement("div",{className:"row"},React.createElement("div",{className:"row",style:{paddingBottom:"5px",paddingLeft:"15px"}},React.createElement("div",{className:"col-lg-4"},React.createElement("a",{"data-toggle":"collapse","data-target":i},React.createElement("span",{onMouseEnter:this.showTooltip.bind(this,"reply"),id:e,"data-toggle":"tooltip",title:"Svar",className:"label label-primary"},React.createElement("span",{className:"glyphicon glyphicon-envelope"}))))),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-lg-offset-1 col-lg-10 collapse",id:r},React.createElement("textarea",{className:"form-control",value:this.state.reply,onChange:this.handleReplyChange,rows:"4"}),React.createElement("br",null),React.createElement("button",{type:"button","data-toggle":"collapse","data-target":i,className:"btn btn-default"},"Luk"),React.createElement("button",{type:"button",className:"btn btn-info",onClick:this.reply},"Svar"))))},t}(React.Component),Comment=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.render=function(){var n=this.props,f=n.commentId,e=n.postedOn,i=n.authorId,r=n.text,o=n.replies,t=n.handlers,s=n.constructComments,h=t.replyHandle,c=t.editHandle,l=t.deleteHandle,a=t.canEdit,v=t.getUser,u=v(i),y=u.FirstName+" "+u.LastName,p=a(i),w=s(o,t),b=formatText(r);return React.createElement("div",{className:"media pull-left text-left"},React.createElement(CommentProfile,null),React.createElement("div",{className:"media-body"},React.createElement("h5",{className:"media-heading"},React.createElement("strong",null,y)," ",React.createElement(PostedOn,{postedOn:e})),React.createElement("span",{dangerouslySetInnerHTML:b}),React.createElement(CommentControls,{canEdit:p,commentId:f,deleteHandle:l,editHandle:c,replyHandle:h,text:r}),w))},t}(React.Component),PostedOn=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.ago=function(){var n=this.props,t=n.postedOn;return timeText(t)},t.prototype.render=function(){return React.createElement("small",null,"sagde ",this.ago())},t}(React.Component),compactHandlers=function(n,t,i,r,u){return{replyHandle:n,editHandle:t,deleteHandle:i,canEdit:r,getUser:u}},CommentList=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.constructComments=function i(n,t){if(n&&n.length!=0)return n.map(function(n){var r="commentId"+n.CommentID;return n.Deleted?React.createElement("div",{className:"media",key:r},React.createElement(CommentDeleted,{key:r,replies:n.Replies,handlers:t,constructComments:i})):React.createElement("div",{className:"media",key:r},React.createElement(Comment,{key:r,postedOn:n.PostedOn,authorId:n.AuthorID,text:n.Text,replies:n.Replies,commentId:n.CommentID,handlers:t,constructComments:i}))})},t.prototype.render=function(){var n=this.props,t=n.comments,i=n.replyHandle,r=n.editHandle,u=n.deleteHandle,f=n.canEdit,e=n.getUser,h=n.userId,o=compactHandlers(i,r,u,f,e),s=this.constructComments(t,o);return React.createElement("div",null,s)},t}(React.Component),Pagination=function(n){function t(){n.apply(this,arguments)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.prevView=function(){var n=this.props,t=n.currentPage,i=n.prev,r=!(t===1);return r?React.createElement("li",null,React.createElement("a",{href:"#","aria-label":"Previous",onClick:i},React.createElement("span",{"aria-hidden":"true"},"«"))):React.createElement("li",{className:"disabled"},React.createElement("span",{"aria-hidden":"true"},"«"))},t.prototype.nextView=function(){var n=this.props,t=n.totalPages,i=n.currentPage,r=n.next,u=!(t===i)&&!(t===0);return u?React.createElement("li",null,React.createElement("a",{href:"#","aria-label":"Next",onClick:r},React.createElement("span",{"aria-hidden":"true"},"»"))):React.createElement("li",{className:"disabled"},React.createElement("span",{"aria-hidden":"true"},"»"))},t.prototype.render=function(){for(var t,u,i=this.props,f=i.totalPages,e=i.imageId,o=i.currentPage,s=i.getPage,r=[],n=1;n<=f;n++)t="page_item_"+(e+n),n===o?r.push(React.createElement("li",{className:"active",key:t},React.createElement("a",{href:"#",key:t},n))):r.push(React.createElement("li",{key:t,onClick:s.bind(null,n)},React.createElement("a",{href:"#",key:t},n)));return u=r.length>0,u?React.createElement("div",null,React.createElement("div",{className:"col-lg-offset-1 col-lg-9"},React.createElement("nav",null,React.createElement("ul",{className:"pagination"},this.prevView(),r,this.nextView())))):null},t}(React.Component),CommentForm=function(n){function t(t){n.call(this,t);this.state={Text:""};this.postComment=this.postComment.bind(this);this.handleTextChange=this.handleTextChange.bind(this)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.postComment=function(n){n.preventDefault();var t=this.props,i=t.postHandle;i(this.state.Text);this.setState({Text:""})},t.prototype.handleTextChange=function(n){this.setState({Text:n.target.value})},t.prototype.render=function(){return React.createElement("form",{onSubmit:this.postComment},React.createElement("label",{htmlFor:"remark"},"Kommentar"),React.createElement("textarea",{className:"form-control",onChange:this.handleTextChange,value:this.state.Text,placeholder:"Skriv kommentar her...",id:"remark",rows:"4"}),React.createElement("br",null),React.createElement("button",{type:"submit",className:"btn btn-primary"},"Send"))},t}(React.Component),mapStateToProps$5=function(n){return{imageId:n.imagesInfo.selectedImageId,skip:n.commentsInfo.skip,take:n.commentsInfo.take,page:n.commentsInfo.page,totalPages:n.commentsInfo.totalPages,comments:n.commentsInfo.comments,getUser:function(t){return underscore.find(n.usersInfo.users,function(n){return n.ID==t})},canEdit:function(t){return n.usersInfo.currentUserId==t},userId:n.usersInfo.currentUserId}},mapDispatchToProps$5=function(n){return{loadComments:function(t,i,r){n(fetchComments(t,i,r))},postReply:function(t,i,r){n(postComment(t,r,i))},postComment:function(t,i){n(postComment(t,i,null))},editComment:function(t,i,r){n(editComment(i,t,r))},deleteComment:function(t,i){n(deleteComment(i,t))}}},CommentsContainer=function(n){function t(t){n.call(this,t);this.nextPage=this.nextPage.bind(this);this.getPage=this.getPage.bind(this);this.previousPage=this.previousPage.bind(this)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.nextPage=function(){var n=this.props,i=n.loadComments,r=n.imageId,u=n.skip,t=n.take,f=u+t;i(r,f,t)},t.prototype.getPage=function(n){var t=this.props,r=t.loadComments,u=t.imageId,i=t.take,f=n-1,e=f*i;r(u,e,i)},t.prototype.previousPage=function(){var n=this.props,i=n.loadComments,r=n.imageId,u=n.skip,t=n.take,f=u-t;i(r,f,t)},t.prototype.componentDidMount=function(){var n=this.props,t=n.loadComments,i=n.imageId,r=n.skip,u=n.take;t(i,r,u)},t.prototype.render=function(){var n=this.props,i=n.comments,r=n.postReply,u=n.editComment,f=n.postComment,e=n.deleteComment,o=n.canEdit,s=n.getUser,l=n.userId,t=n.imageId,h=n.page,c=n.totalPages;return React.createElement("div",{className:"text-left"},React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lgOffset:1,lg:11},React.createElement(CommentList,{comments:i,replyHandle:r.bind(null,t),editHandle:u.bind(null,t),deleteHandle:e.bind(null,t),canEdit:o,getUser:s}))),React.createElement(reactBootstrap.Row,null,React.createElement(Pagination,{imageId:t,currentPage:h,totalPages:c,next:this.nextPage,prev:this.previousPage,getPage:this.getPage})),React.createElement("hr",null),React.createElement(reactBootstrap.Row,null,React.createElement(reactBootstrap.Col,{lgOffset:1,lg:10},React.createElement(CommentForm,{postHandle:f.bind(null,t)}))))},t}(React.Component),Comments=reactRedux.connect(mapStateToProps$5,mapDispatchToProps$5)(CommentsContainer),mapStateToProps$4=function(n){var i=n.imagesInfo.ownerId,r=n.usersInfo.currentUserId,f=i>0&&r>0&&i==r,u=function(t){return underscore.find(n.imagesInfo.images,function(n){return n.ImageID==t})},t=function(){return u(n.imagesInfo.selectedImageId)},e=function(){return t()?t().Filename:""},o=function(){return t()?t().PreviewUrl:""},s=function(){return t()?t().Extension:""},h=function(){return t()?t().OriginalUrl:""},c=function(){return t()?t().Uploaded:new Date};return{canEdit:f,hasImage:Boolean(u(n.imagesInfo.selectedImageId)),filename:e(),previewUrl:o(),extension:s(),originalUrl:h(),uploaded:c()}},mapDispatchToProps$4=function(n){return{setSelectedImageId:function(t){n(setSelectedImg(t))},deselectImage:function(){n(setSelectedImg(undefined))},setError:function(t){n(setError(t))},fetchImage:function(t){n(fetchSingleImage(t))},deleteImage:function(t,i){n(deleteImage(t,i))}}},ModalImage=function(n){function t(t){n.call(this,t);this.deleteImage=this.deleteImage.bind(this);this.open=this.open.bind(this);this.close=this.close.bind(this)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.open=function(){var n=this.props,t=n.hasImage,i=n.setError;return t?!0:(i({title:"Oops something went wrong",message:"Could not find the image, maybe the URL is invalid or it has been deleted!"}),!1)},t.prototype.close=function(){var t=this.props,i=t.deselectImage,r=this.props.params,u=r.username,f=this.props.router,e=f.push,n;i();n="/"+u+"/gallery";e(n)},t.prototype.deleteImage=function(){var t=this.props,i=t.deleteImage,n=this.props.params,r=n.id,u=n.username;i(r,u);$(ReactDOM.findDOMNode(this)).modal("hide")},t.prototype.deleteImageView=function(){var n=this.props,t=n.canEdit;return t?React.createElement(reactBootstrap.Button,{bsStyle:"danger",onClick:this.deleteImage},"Slet billede"):null},t.prototype.render=function(){var n=this.props,i=n.filename,r=n.previewUrl,u=n.extension,f=n.originalUrl,e=n.uploaded,o=i+"."+u,t=moment(e),s="Uploaded d. "+t.format("D MMM YYYY ")+"kl. "+t.format("H:mm");return React.createElement(reactBootstrap.Modal,{show:this.open(),onHide:this.close,bsSize:"large"},React.createElement(reactBootstrap.Modal.Header,{closeButton:!0},React.createElement(reactBootstrap.Modal.Title,null,o,React.createElement("span",null,React.createElement("small",null," - ",s)))),React.createElement(reactBootstrap.Modal.Body,null,React.createElement("a",{href:f,target:"_blank",rel:"noopener"},React.createElement(reactBootstrap.Image,{src:r,responsive:!0}))),React.createElement(reactBootstrap.Modal.Footer,null,React.createElement(Comments,null),React.createElement("hr",null),React.createElement(reactBootstrap.ButtonToolbar,{style:{float:"right"}},this.deleteImageView(),React.createElement(reactBootstrap.Button,{onClick:this.close},"Luk"))))},t}(React.Component),SelectedImageRedux=reactRedux.connect(mapStateToProps$4,mapDispatchToProps$4)(ModalImage),SelectedImage=reactRouter.withRouter(SelectedImageRedux);store.dispatch(fetchCurrentUser(globals.currentUsername));moment.locale("da");selectImage=function(n){var t=n.params.id;store.dispatch(setSelectedImg(t))};fetchImages=function(n){var t=n.params.username;store.dispatch(setImageOwner(t));store.dispatch(fetchUserImages(t))};ReactDOM.render(React.createElement(reactRedux.Provider,{store:store},React.createElement(reactRouter.Router,{history:reactRouter.browserHistory},React.createElement(reactRouter.Route,{path:"/",component:Main},React.createElement(reactRouter.IndexRoute,{component:Home}),React.createElement(reactRouter.Route,{path:"users",component:Users}),React.createElement(reactRouter.Route,{path:"about",component:About}),React.createElement(reactRouter.Route,{path:":username/gallery",component:UserImages,onEnter:fetchImages},React.createElement(reactRouter.Route,{path:"image/:id",component:SelectedImage,onEnter:selectImage}))))),document.getElementById("content"));